{"remainingRequest":"/Users/songqingyu/Documents/GitHub/sustainKG/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js??vue-loader-options!/Users/songqingyu/Documents/GitHub/sustainKG/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/songqingyu/Documents/GitHub/sustainKG/src/App.vue","mtime":1627295267255},{"path":"/Users/songqingyu/Documents/GitHub/sustainKG/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/songqingyu/Documents/GitHub/sustainKG/node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/songqingyu/Documents/GitHub/sustainKG/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/songqingyu/Documents/GitHub/sustainKG/node_modules/_vue-loader@15.9.7@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIGQzIGZyb20gImQzIjsKaW1wb3J0IGhhaGFoYSBmcm9tICdub2RlLTd6JwoKaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JwppbXBvcnQgewogICAgZ2V0Tm9kZVNlbGZQYXRoLAogICAgc2V0TGlua0dyb3VwLAogICAgZ2V0Tm9kZXNMaW5lLH0gZnJvbSAnLi91dGlscy9kZXZpY2VSZWxhdGlvbicKCgoKCmV4cG9ydCBkZWZhdWx0IHsKCgogICAgZGF0YSgpewoKCgogICAgICAgIGxldCBpbmZvID0gewogICAgICAgICAgICAibGlua3MiOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgInNvdXJjZSIgOiAwLAogICAgICAgICAgICAgICAgICAgICJ0YXJnZXQiIDogMSwKICAgICAgICAgICAgICAgICAgICAidHlwZSIgOiAibGluayIsCiAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJzogJ0xpbmsgVEVTVCcsCiAgICAgICAgICAgICAgICAgICAgInByb3BlcnRpZXMiOnt9CgogICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgICJub2RlcyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAiaWQiOiAwLAogICAgICAgICAgICAgICAgICAgICJ0eXBlIiA6ICJub2RlIiwKICAgICAgICAgICAgICAgICAgICAibGFiZWwiIDogIkRldmljZSIsCiAgICAgICAgICAgICAgICAgICAgInByb3BlcnRpZXMiOnsibmFtZSI6ImhlbGxvIn0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgImlkIjogMSwKICAgICAgICAgICAgICAgICAgICAidHlwZSIgOiAibm9kZSIsCiAgICAgICAgICAgICAgICAgICAgImxhYmVsIjogIkRldmljZSIsCiAgICAgICAgICAgICAgICAgICAgInByb3BlcnRpZXMiOnsibmFtZSI6IndpbGwifQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAiaWQiOiAyLAogICAgICAgICAgICAgICAgICAgICJ0eXBlIiA6ICJub2RlIiwKICAgICAgICAgICAgICAgICAgICAibGFiZWwiOiAiRGV2aWNlIiwKICAgICAgICAgICAgICAgICAgICAicHJvcGVydGllcyI6eyJuYW1lIjoibGFsYSJ9CiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgXQogICAgICAgIH07CgoKCiAgICAgICAgcmV0dXJuIHsKCiAgICAgICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgogICAgICAgICAgICAvLyBsb2cgZnVuY3Rpb24gcGFyYW1ldGVycwogICAgICAgICAgICBjdXJyZW50X3VzZXI6JycsCiAgICAgICAgICAgIHVzZXJuYW1lOicnLAogICAgICAgICAgICBwYXNzd29yZDonJywKICAgICAgICAgICAgbmV3VXNlcm5hbWU6JycsCiAgICAgICAgICAgIG5ld1Bhc3N3b3JkOicnLAogICAgICAgICAgICBzaG93TG9naW46dHJ1ZSwKICAgICAgICAgICAgY2VudGVyRGlhbG9nVmlzaWJsZTpmYWxzZSwKICAgICAgICAgICAgZGlhbG9nX2NyZWF0ZVVzZXI6ZmFsc2UsCiAgICAgICAgICAgIG9wdGlvblZpc2libGU6ZmFsc2UsCiAgICAgICAgICAgIG9wdGlvblZpc2libGVfbGluazpmYWxzZSwKICAgICAgICAgICAgdXBsb2FkX25vZGVzOicnLAogICAgICAgICAgICB1cGxvYWRfbGlua3M6JycsCgoKICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KCiAgICAgICAgICAgIG5vZGVfdmFsdWU6ICcnLAogICAgICAgICAgICBsaW5rX3ZhbHVlOicnLAogICAgICAgICAgICBidG5DaGFuZ2VFbmFibGU6IHRydWUsCiAgICAgICAgICAgIG5vZGVfbGlzdDogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHZhbHVlOiAnbm9kZTEnLAogICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnbm9kZTEnCiAgICAgICAgICAgICAgICB9LAoKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJ25vZGUyJywKICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ25vZGUyJwogICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICd0ZXN0MycsCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICd0ZXN0MycKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICdiYmInLAogICAgICAgICAgICAgICAgICAgIGxhYmVsOiAnYmJiJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAoKICAgICAgICAgICAgbGlua19saXN0OiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICdsaW5rMScsCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdsaW5rMScKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICdsaW5rMicsCiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdsaW5rMicKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICd0ZXN0XzMnLAogICAgICAgICAgICAgICAgICAgIGxhYmVsOiAndGVzdF8zJwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAoKICAgICAgICAgICAgaW5mbzogewogICAgICAgICAgICAgICAgbm9kZXM6W10sCiAgICAgICAgICAgICAgICBsaW5rczpbXQogICAgICAgICAgICB9LAoKICAgICAgICAgICAgLy8gaW5mbzogaW5mbywKCiAgICAgICAgICAgIGlmQ2xpY2tlZDpmYWxzZSwKCiAgICAgICAgICAgIHNlbGVjdGVkX05vZGU6ICcnLAoKICAgICAgICAgICAgZGlhbG9nRm9ybVZpc2libGU6ZmFsc2UsCiAgICAgICAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlX2xpbms6ZmFsc2UsCiAgICAgICAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlX2NoYW5nZV9ub2RlX25hbWU6ZmFsc2UsCiAgICAgICAgICAgIGRpYWxvZ0Zvcm1WaXNpYmxlX2NoYW5nZV9saW5rX25hbWU6ZmFsc2UsCiAgICAgICAgICAgIHRlbXAgOiBbXSwKICAgICAgICAgICAgY2xpY2tUaW1lSWQgOiAwLAoKICAgICAgICAgICAgbm9kZV9pZDogJycsCiAgICAgICAgICAgIGxpbmtfaWQ6ICcnLAogICAgICAgICAgICBuZXdfbGlua19uYW1lOicnLAogICAgICAgICAgICBuZXdfbm9kZV9uYW1lOicnLAoKICAgICAgICAgICAgbWVudTogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRGVsZXRlIE5vZGVzJywKICAgICAgICAgICAgICAgICAgICBhY3Rpb246IChub2RlLHNlbGVjdF9ub2RlKSA9PiB7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRjb25maXJtKCJEZWxldGUgdGhpcyBub2RlPyIsICJUaXBzIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogIk5vIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1RoZSBub2RlIGlzIGRlbGV0ZWQhJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Rlc3QgISEhJyxzZWxlY3Rfbm9kZSxub2RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5mby5ub2Rlcy5zcGxpY2Uobm9kZSwxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9dGhpcy5pbmZvLmxpbmtzLmxlbmd0aC0xOyBpPj0wOyBpLS0gKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsaW5rIGluZGV4JyxpLG5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuaW5mby5saW5rc1tpXS5zb3VyY2UgPT09IHNlbGVjdF9ub2RlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IHRoaXMuaW5mby5saW5rc1tpXS50YXJnZXQgPT09IHNlbGVjdF9ub2RlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmZvLmxpbmtzLnNwbGljZShpLDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FmdGVyIGRlbGV0ZScsIHRoaXMuaW5mbykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyR3JhcGgodGhpcy5pbmZvKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ2FuY2VsIERlbGV0ZSEnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIH0sCgoKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdDaGFuZ2UgTm9kZSBOYW1lJywKICAgICAgICAgICAgICAgICAgICBhY3Rpb246KG5vZGVfaWQpPT57CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGVfY2hhbmdlX25vZGVfbmFtZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZV9pZCA9IG5vZGVfaWQ7CgogICAgICAgICAgICAgICAgICAgIH0sCgogICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIF0sCgogICAgICAgICAgICBtZW51X2VkZ2U6WwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRGVsZXRlIExpbmtzJywKICAgICAgICAgICAgICAgICAgICBhY3Rpb246IChsaW5rLHNlbGVjdGVkX2xpbmspID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xsJyxsaW5rLHNlbGVjdGVkX2xpbmspOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRjb25maXJtKCJEZWxldGUgdGhpcyBsaW5rPyIsICJUaXBzIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICJZZXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogIk5vIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1RoZSBsaW5rIGlzIGRlbGV0ZWQhJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmZvLmxpbmtzLnNwbGljZShsaW5rLDEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJHcmFwaCh0aGlzLmluZm8pOwoKICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdDYW5jZWwgRGVsZXRlIScKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgfSwKCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnQ2hhbmdlIGxpbmsgTmFtZScsCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOihsaW5rX2lkKT0+CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlX2NoYW5nZV9saW5rX25hbWUgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmtfaWQgPSBsaW5rX2lkOwoKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAoKCgogICAgICAgIH0KICAgIH0sCgogICAgbW91bnRlZCgpIHsKCiAgICAgICAgdGhpcy5yZW5kZXJHcmFwaCh0aGlzLmluZm8pOwoKICAgIH0sCgogICAgbWV0aG9kczogewogICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwogICAgICAgIC8vIGxvZ2luIGZ1bmN0aW9ucwoKICAgICAgICBjcmVhdGVVc2VyOmZ1bmN0aW9uKCl7CgogICAgICAgICAgICB0aGlzLmRpYWxvZ19jcmVhdGVVc2VyICA9IGZhbHNlOwogICAgICAgICAgICBjb25zb2xlLmxvZygnY3JlYXRlIHVzZXIgZnVuY3Rpb24nLHRoaXMubmV3VXNlcm5hbWUsIHRoaXMubmV3UGFzc3dvcmQpCgogICAgICAgICAgICB0aGlzLiRheGlvcyh7CiAgICAgICAgICAgICAgICB1cmwgOiAnL2NyZWF0ZU5ld1VzZXInLAogICAgICAgICAgICAgICAgbWV0aG9kIDogJ3Bvc3QnLAogICAgICAgICAgICAgICAgZGF0YSA6CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAidXNlciIgOiB0aGlzLm5ld1VzZXJuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAicGFzc3dvcmQiIDogdGhpcy5uZXdQYXNzd29yZAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihyZXNwb25zZT0+ewogICAgICAgICAgICAgICAgdGhpcy51c2VybmFtZSA9IHRoaXMubmV3VXNlcm5hbWU7CiAgICAgICAgICAgICAgICB0aGlzLnBhc3N3b3JkID0gdGhpcy5uZXdQYXNzd29yZDsKICAgICAgICAgICAgICAgIHRoaXMubmV3UGFzc3dvcmQgPSAnJzsKICAgICAgICAgICAgICAgIHRoaXMubmV3VXNlcm5hbWUgPSAnJzsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjA0KQogICAgICAgICAgICAgICAgewoKICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKAoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1RoZSB1c2VybmFtZSBpcyBleGlzdGVkICEnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvZ2luID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ19jcmVhdGVVc2VyICA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VybmFtZSA9ICcnOwogICAgICAgICAgICAgICAgICAgIHRoaXMucGFzc3dvcmQgPSAnJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewoKICAgICAgICAgICAgICAgICAgICB0aGlzLiRheGlvcyh7CiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogJy9nZXRVc2VyR3JhcGgnLAogICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyOiB0aGlzLnVzZXJuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG93TG9naW4gPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVzZXJfbm9kZXMgPSByZXNwb25zZS5kYXRhLm5vZGVzOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXNlcl9saW5rcyA9IHJlc3BvbnNlLmRhdGEubGlua3M7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjaGFuZ2Vfbm9kZV90eXBlID0gdXNlcl9ub2Rlcy5tYXAoZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaWQgPSBOdW1iZXIoZWxlbWVudC5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNoYW5nZV9saW5rX3R5cGUgPSB1c2VyX2xpbmtzLm1hcChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9IE51bWJlcihlbGVtZW50LmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc291cmNlID0gTnVtYmVyKGVsZW1lbnQuc291cmNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudGFyZ2V0ID0gTnVtYmVyKGVsZW1lbnQudGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmZvLm5vZGVzID0gY2hhbmdlX25vZGVfdHlwZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmZvLmxpbmtzID0gY2hhbmdlX2xpbmtfdHlwZTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50X3VzZXIgPSByZXNwb25zZS5kYXRhLnVzZXI7CgogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlckdyYXBoKHRoaXMuaW5mbykKCgogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCgogICAgICAgIH0sCgogICAgICAgIGdldFdpa2lwZWRpYTpmdW5jdGlvbigpewoKICAgICAgICAgICAgY29uc3QgbXlTdHJlYW0gPSBoYWhhaGEubGlzdCgnL3dpa2lfYXJ0aWNsZXNfbGlzdC43eicpCiAgICAgICAgICAgIGNvbnNvbGUubG9nKG15U3RyZWFtKQoKCgoKICAgICAgICAgICAgLy8gdGhpcy4kYXhpb3MoewogICAgICAgICAgICAvLwogICAgICAgICAgICAvLyAgICAgbWV0aG9kIDogJ2dldCcsCiAgICAgICAgICAgIC8vICAgICB1cmwgOiAnL2dldEFsbFdpa2lwZWRpYUFydGljbGVzJywKICAgICAgICAgICAgLy8gICAgIGRhdGE6IHt9CiAgICAgICAgICAgIC8vIH0pLnRoZW4ocmVzcG9uc2U9PnsKICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICAgICAgICAvLyB9KQogICAgICAgIH0sCgoKICAgICAgICBoYW5kbGVTaG93OmZ1bmN0aW9uKCl7CgoKCgogICAgICAgICAgICAgICAgdGhpcy5jZW50ZXJEaWFsb2dWaXNpYmxlPWZhbHNlOwogICAgICAgICAgICAgICAgdGhpcy4kYXhpb3MoewogICAgICAgICAgICAgICAgICAgIHVybDonL2dldFVzZXJHcmFwaCcsCiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOidwb3N0JywKICAgICAgICAgICAgICAgICAgICBkYXRhOnsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlciA6ICJzb21lX3VzZXIiLAogICAgICAgICAgICAgICAgICAgICAgICAvLyBwYXNzd29yZDogIm15X3Bhc3N3b3JkIgogICAgICAgICAgICAgICAgICAgICAgICB1c2VyIDogdGhpcy51c2VybmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHRoaXMucGFzc3dvcmQKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfSkudGhlbihyZXNwb25zZT0+ewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2dpbj1mYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2hhaGEnLHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgdXNlcl9ub2RlcyA9IHJlc3BvbnNlLmRhdGEubm9kZXM7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB1c2VyX2xpbmtzID0gcmVzcG9uc2UuZGF0YS5saW5rczsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGV0IHRlc3QgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNoYW5nZV9ub2RlX3R5cGUgPSB1c2VyX25vZGVzLm1hcChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9IE51bWJlcihlbGVtZW50LmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNoYW5nZV9saW5rX3R5cGUgPSB1c2VyX2xpbmtzLm1hcChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pZCA9IE51bWJlcihlbGVtZW50LmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc291cmNlID0gTnVtYmVyKGVsZW1lbnQuc291cmNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQudGFyZ2V0ID0gTnVtYmVyKGVsZW1lbnQudGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2hhbmdlX25vZGVfdHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNoYW5nZV9saW5rX3R5cGUpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluZm8ubm9kZXMgPSBjaGFuZ2Vfbm9kZV90eXBlOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmluZm8ubGlua3MgPSBjaGFuZ2VfbGlua190eXBlOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRfdXNlciA9IHJlc3BvbnNlLmRhdGEudXNlcjsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJHcmFwaCh0aGlzLmluZm8pCgogICAgICAgICAgICAgICAgfSkuY2F0Y2goZXJyb3I9PnsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyb3InLGVycm9yKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dMb2dpbiA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgdGhpcy51c2VybmFtZSA9ICcnOwogICAgICAgICAgICAgICAgICAgIHRoaXMucGFzc3dvcmQgPSAnJzsKICAgICAgICAgICAgICAgIH0pCgoKICAgICAgICB9LAoKICAgICAgICBvblRhcExvZ2luOmZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdGhpcy5jZW50ZXJEaWFsb2dWaXNpYmxlPXRydWUKICAgICAgICB9LAoKICAgICAgICBsb2dvdXQ6ZnVuY3Rpb24gKCkgewogICAgICAgICAgICB0aGlzLnNob3dMb2dpbiA9IHRydWU7CiAgICAgICAgICAgIHRoaXMudXNlcm5hbWUgPSAnJzsKICAgICAgICAgICAgdGhpcy5wYXNzd29yZCA9ICcnOwogICAgICAgICAgICB0aGlzLmluZm89IHsKICAgICAgICAgICAgICAgIG5vZGVzOltdLAogICAgICAgICAgICAgICAgICAgIGxpbmtzOltdCiAgICAgICAgICAgIH07CgogICAgICAgICAgICB0aGlzLnJlbmRlckdyYXBoKHRoaXMuaW5mbykKCiAgICAgICAgICAgIC8vIHRoaXMuJHJvdXRlci5wdXNoKHsgcGF0aDogJy8nIH0pCiAgICAgICAgfSwKCiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgoKCiAgICAgICAgc2hvd09wdGlvbigpCiAgICAgICAgewogICAgICAgICAgICBsZXQgaW5wdXRDb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZWwtaW5wdXRfX2lubmVyJylbMF0udmFsdWU7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGlucHV0Q29udGVudC5sZW5ndGgpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlbC1pbnB1dF9faW5uZXInKSkKICAgICAgICAgICAgdGhpcy5vcHRpb25WaXNpYmxlID0gaW5wdXRDb250ZW50Lmxlbmd0aCA+PTI7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvcHRpb24nLHRoaXMub3B0aW9uVmlzaWJsZSk7CiAgICAgICAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCkKICAgICAgICB9LAoKICAgICAgICBzaG93T3B0aW9uX2xpbmsoKQogICAgICAgIHsKICAgICAgICAgICAgbGV0IGlucHV0Q29udGVudCA9ICcnCiAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlbC1pbnB1dF9faW5uZXInKS5sZW5ndGggPT09IDEpIHsKICAgICAgICAgICAgICAgIGlucHV0Q29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2VsLWlucHV0X19pbm5lcicpWzBdLnZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICBpbnB1dENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlbC1pbnB1dF9faW5uZXInKVsxXS52YWx1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zb2xlLmxvZyhkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdlbC1pbnB1dF9faW5uZXInKSkKICAgICAgICAgICAgY29uc29sZS5sb2coaW5wdXRDb250ZW50Lmxlbmd0aCk7CgogICAgICAgICAgICB0aGlzLm9wdGlvblZpc2libGVfbGluayA9IGlucHV0Q29udGVudC5sZW5ndGggPj0yOwogICAgICAgICAgICBjb25zb2xlLmxvZygnb3B0aW9uJyx0aGlzLm9wdGlvblZpc2libGVfbGluayk7CiAgICAgICAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCkKICAgICAgICB9LAoKCiAgICAgICAgc2VsZWN0Qmx1cihlKSB7CiAgICAgICAgICAgIC8vIOaEj+ingeexu+WeiwogICAgICAgICAgICB0aGlzLmJ0bkNoYW5nZUVuYWJsZSA9IHRydWU7CiAgICAgICAgICAgIGlmIChlLnRhcmdldC52YWx1ZSAhPT0gJycpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyBzZWxlY3Rpb24nLGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgICAgIC8vIHRoaXMuJGZvcmNlVXBkYXRlKCkgICAvLyDlvLrliLbmm7TmlrAKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiRmb3JjZVVwZGF0ZSgpCiAgICAgICAgICAgIHRoaXMuc2VsZWN0Q2xlYXIoKQogICAgICAgIH0sCgogICAgICAgIHNlbGVjdENsZWFyKCkgewogICAgICAgICAgICB0aGlzLm5vZGVfdmFsdWUgPSAnJzsKICAgICAgICAgICAgdGhpcy5saW5rX3ZhbHVlID0gJyc7CiAgICAgICAgICAgIHRoaXMubmV3X25vZGVfbmFtZSA9ICcnOwogICAgICAgICAgICB0aGlzLm5ld19saW5rX25hbWUgPSAnJzsKICAgICAgICAgICAgdGhpcy5vcHRpb25WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMub3B0aW9uVmlzaWJsZV9saW5rID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCkKICAgICAgICB9LAoKICAgICAgICBzZWxlY3RDaGFuZ2UodmFsKSB7CgogICAgICAgICAgICBpZih2YWwgIT09ICcnKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB0aGlzLmJ0bkNoYW5nZUVuYWJsZSA9IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYodGhpcy5kaWFsb2dGb3JtVmlzaWJsZV9saW5rPT09dHJ1ZSl7CiAgICAgICAgICAgICAgICB0aGlzLmxpbmtfdmFsdWUgPSB2YWwKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmICh0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlX2NoYW5nZV9saW5rX25hbWUgPT09IHRydWUpewogICAgICAgICAgICAgICAgdGhpcy5uZXdfbGlua19uYW1lID0gdmFsCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5kaWFsb2dGb3JtVmlzaWJsZV9jaGFuZ2Vfbm9kZV9uYW1lID09PSB0cnVlKXsKICAgICAgICAgICAgICAgIHRoaXMubmV3X25vZGVfbmFtZSA9IHZhbAogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYodGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9PT0gdHJ1ZSl7CiAgICAgICAgICAgICAgICB0aGlzLm5vZGVfdmFsdWUgPSB2YWw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy4kZm9yY2VVcGRhdGUoKQogICAgICAgIH0sCgoKICAgICAgICBjYW5jZWwoKQogICAgICAgIHsKICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlX2xpbmsgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZV9jaGFuZ2Vfbm9kZV9uYW1lID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGVfY2hhbmdlX2xpbmtfbmFtZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnNlbGVjdENsZWFyKCk7CiAgICAgICAgICAgIHRoaXMudGVtcC5sZW5ndGggPSAwOwogICAgICAgICAgICB0aGlzLm5ld1Bhc3N3b3JkID0gJyc7CiAgICAgICAgICAgIHRoaXMubmV3VXNlcm5hbWUgPSAnJzsKICAgICAgICAgICAgdGhpcy5idG5DaGFuZ2VFbmFibGUgPSB0cnVlOwogICAgICAgIH0sCgogICAgICAgIGFkZE5vZGVzKCl7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5kb3VibGVDbGljayh0aGlzLmluZm8sIHRoaXMuaW5mby5ub2RlcywgdGhpcy5ub2RlX3ZhbHVlKTsKICAgICAgICAgICAgdGhpcy5zZWxlY3RDbGVhcigpOwogICAgICAgICAgICB0aGlzLm9wdGlvblZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5vcHRpb25WaXNpYmxlX2xpbmsgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5idG5DaGFuZ2VFbmFibGUgPSB0cnVlOwoKICAgICAgICB9LAoKICAgICAgICBjaGFuZ2Vfbm9kZV9uYW1lKCl7CgogICAgICAgICAgICB0aGlzLmluZm8ubm9kZXNbdGhpcy5ub2RlX2lkXS5wcm9wZXJ0aWVzLm5hbWUgPSB0aGlzLm5ld19ub2RlX25hbWU7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGVfY2hhbmdlX25vZGVfbmFtZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnNlbGVjdENsZWFyKCk7CiAgICAgICAgICAgIHRoaXMub3B0aW9uVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLm9wdGlvblZpc2libGVfbGluayA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLmJ0bkNoYW5nZUVuYWJsZSA9IHRydWU7CiAgICAgICAgICAgIHRoaXMucmVuZGVyR3JhcGgodGhpcy5pbmZvKTsKICAgICAgICB9LAoKCiAgICAgICAgY2hhbmdlX2xpbmtfbmFtZSgpCiAgICAgICAgewoKICAgICAgICAgICAgdGhpcy5pbmZvLmxpbmtzW3RoaXMubGlua19pZF0ubGFiZWwgPSB0aGlzLm5ld19saW5rX25hbWU7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGVfY2hhbmdlX2xpbmtfbmFtZSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnNlbGVjdENsZWFyKCk7CiAgICAgICAgICAgIHRoaXMuYnRuQ2hhbmdlRW5hYmxlID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5vcHRpb25WaXNpYmxlID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMub3B0aW9uVmlzaWJsZV9saW5rID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMucmVuZGVyR3JhcGgodGhpcy5pbmZvKQogICAgICAgIH0sCgogICAgICAgIGFkZExpbmtzKCkKICAgICAgICB7CgogICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlX2xpbmsgPSBmYWxzZTsKCiAgICAgICAgICAgIGlmICh0aGlzLnRlbXAubGVuZ3RoID09PSAyKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNpbmdsZUNsaWNrKHRoaXMuaW5mbywgdGhpcy5zZWxlY3RlZF9Ob2RlLCB0aGlzLmxpbmtfdmFsdWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKAoKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ0FkZCBMaW5rcyEnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5idG5DaGFuZ2VFbmFibGUgPSB0cnVlOwogICAgICAgICAgICB0aGlzLm9wdGlvblZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5vcHRpb25WaXNpYmxlX2xpbmsgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5zZWxlY3RDbGVhcigpCgogICAgICAgIH0sCgoKICAgICAgICByZW5kZXJHcmFwaChpbmZvKSB7CiAgICAgICAgICAgIC8vIGxldCB0ZW1wID0gW107CgoKICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbmRlciBkYXRhJyxpbmZvKTsKICAgICAgICAgICAgbGV0IHtsaW5rcywgbm9kZXN9ID0gaW5mbzsKCiAgICAgICAgICAgIC8v5YWz57O75YiG57uECiAgICAgICAgICAgIHNldExpbmtHcm91cChsaW5rcyk7CgoKICAgICAgICAgICAgZDMuc2VsZWN0KCIjZ3JhcGgiKS5odG1sKCcnKTsKCgogICAgICAgICAgICBsZXQgZm9yY2UgPSBkMy5sYXlvdXQuZm9yY2UoKS8vbGF5b3V05bCGanNvbuagvOW8j+i9rOWMluS4uuWKm+WtpuWbvuWPr+eUqOeahOagvOW8jwogICAgICAgICAgICAgICAgLm5vZGVzKG5vZGVzKS8v6K6+5a6a6IqC54K55pWw57uECiAgICAgICAgICAgICAgICAubGlua3MobGlua3MpLy/orr7lrprov57nur/mlbDnu4QKICAgICAgICAgICAgICAgIC5saW5rRGlzdGFuY2UoNTAwKS8v6L+e5o6l57q/6ZW/5bqmCiAgICAgICAgICAgICAgICAuY2hhcmdlKC0xNTAwKS8v6aG254K555qE55S16I235pWw44CC6K+l5Y+C5pWw5Yaz5a6a5piv5o6S5pal6L+Y5piv5ZC45byV77yM5pWw5YC86LaK5bCP6LaK5LqS55u45o6S5palCiAgICAgICAgICAgICAgICAub24oInRpY2siLCBmdW5jdGlvbiAoKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGljaygpCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICkvL+aMh+aXtumXtOmXtOmalO+8jOmalOS4gOauteaXtumXtOWIt+aWsOS4gOasoeeUu+mdogogICAgICAgICAgICAgICAgLnN0YXJ0KCk7Ly/lvIDlp4vovazmjaIKCgoKICAgICAgICAgICAgbGV0IHpvb20gPSBkMy5iZWhhdmlvci56b29tKCkKICAgICAgICAgICAgICAgIC5zY2FsZUV4dGVudChbLjQsIDJdKQogICAgICAgICAgICAgICAgLm9uKCJ6b29tIiwgem9vbWVkKTsKCiAgICAgICAgICAgIGxldCBzdmcgPSBkMy5zZWxlY3QoIiNncmFwaCIpLmFwcGVuZCgic3ZnIikKICAgICAgICAgICAgICAgIC5hdHRyKCJwb2ludGVyLWV2ZW50IiwgImFsbCIpCiAgICAgICAgICAgICAgICAuYXR0cigicHJlc2VydmVBc3BlY3RSYXRpbyIsICJ4TWlkWU1pZCBtZWV0IikvL+iHqumAguW6lOWuueWZqOWkp+WwjwogICAgICAgICAgICAgICAgLmF0dHIoInZpZXdCb3giLCAiLTQ2MCAtMjIwIDEyMDAgMTIwMCIpCiAgICAgICAgICAgICAgICAvLyAub24oImRibGNsaWNrIiwgZG91YmxlQ2xpY2spCiAgICAgICAgICAgICAgICAuY2FsbCh6b29tKTsKCgoKCiAgICAgICAgICAgIC8vIG9sZF9ub2RlcyA9IG5vZGVzOwogICAgICAgICAgICBsZXQgY2lyY2xlX2cgPSBzdmcuc2VsZWN0QWxsKCJjaXJjbGUiKQogICAgICAgICAgICAgICAgLmRhdGEoZm9yY2Uubm9kZXMoKSkvL+ihqOekuuS9v+eUqGZvcmNlLm5vZGVz5pWw5o2uCiAgICAgICAgICAgICAgICAuZW50ZXIoKQogICAgICAgICAgICAgICAgLmFwcGVuZCgiZyIpCiAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLGZ1bmN0aW9uKG5vZGUsaSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJnX2NpcmNsZV8iICsgaTsgfSkvL+agh+iusGNpcmNsZeeahOeItuiKgueCuQogICAgICAgICAgICAgICAgLnN0eWxlKCJjdXJzb3IiLCJwb2ludGVyIikKICAgICAgICAgICAgICAgIC5jYWxsKGRyYWcoKSkgLy/lsIblvZPliY3pgInkuK3nmoTlhYPntKDkvKDliLBkcmFn5Ye95pWw5Lit77yM5L2/6aG254K55Y+v5Lul6KKr5ouW5YqoCiAgICAgICAgICAgICAgICAub24oImNsaWNrIiwgKG5vZGUsIGksKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGQzLmV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHJldHVybjsKCiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ+m8oOagh+WNleWHuycsdGhpcy5jbGlja1RpbWVJZCk7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZDMuc2VsZWN0KHRoaXMpKQogICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNsaWNrVGltZUlkKTsKCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGlja1RpbWVJZCA9IHNldFRpbWVvdXQoICgpPT4gewoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCLpvKDmoIfljZXlh7siKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLnNlbGVjdGVkX05vZGUgPSBub2RlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5hZGRMaW5rcygpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnc2VsZWN0ZWRfTm9kZScsdGhpcy5zZWxlY3RlZF9Ob2RlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wLnB1c2gobm9kZS5pbmRleCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGl1bGl1Jyx0aGlzLnRlbXApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy50ZW1wLmxlbmd0aCA9PT0gMiAmJiB0aGlzLnRlbXBbMF0gIT09IHRoaXMudGVtcFsxXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZV9saW5rID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKHRoaXMudGVtcC5sZW5ndGggPT09IDIgJiYgdGhpcy50ZW1wWzBdID09PSB0aGlzLnRlbXBbMV0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50ZW1wLmxlbmd0aCA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuc2luZ2xlQ2xpY2soaW5mbywgbm9kZSwgdGVtcCwgdGhpcy5zdGF0ZTIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tTdHlsZShub2RlLCBpLCB0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAsIDI1MCk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC8vIC5vbignbW91c2VvdmVyJywgKG5vZGUpID0+IHsKICAgICAgICAgICAgICAgIC8vICAgICBpZiAoZDMuZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgcmV0dXJuOwogICAgICAgICAgICAgICAgLy8gICAgIC8vIHNob3dOb2RlSW5mbyhub2RlLCB0aGlzKTsKICAgICAgICAgICAgICAgIC8vICAgICAvLyBzaG93Q2lyY2xlQm9yZGVyT3V0ZXJBcmMobm9kZSwgaSk7CiAgICAgICAgICAgICAgICAvLyB9KQogICAgICAgICAgICAgICAgLm9uKCJkYmxjbGljayIsIChub2RlLCApPT57CgoKICAgICAgICAgICAgICAgICAgICBpZiAoZDMuZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkb3VibGUgY2xpY2snLG5vZGVzKTsKICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jbGlja1RpbWVJZCk7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+WPjOWHuycsdGhpcy5jbGlja1RpbWVJZCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dGb3JtVmlzaWJsZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5kb3VibGVDbGljayhpbmZvLCBub2RlLCBub2RlcywgbGlua3MpCgoKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAub24oJ2NvbnRleHRtZW51JywoZCxub2RlKT0+ewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdub2RlISEhISEnLGQsbm9kZSk7CiAgICAgICAgICAgICAgICAgICAgTWVudSh0aGlzLm1lbnUpKGQsIGQzLmV2ZW50LCBub2RlKQoKICAgICAgICAgICAgICAgIH0pOwoKCgoKICAgICAgICAgICAgc3ZnLm9uKCJkYmxjbGljay56b29tIiwgbnVsbCk7Ly/lj5bmtohzdmflkozlnIblnIjnmoTlj4zlh7vmlL7lpKfkuovku7bvvIhkM+S4rem7mOiupOW8gOWQrzfkuKrkuovku7bvvIzlhbPpl63pmLLmraLkuI7kuIrpnaLnmoTlj4zlh7vkuovku7blhrLnqoHvvIkKICAgICAgICAgICAgY2lyY2xlX2cub24oImRibGNsaWNrLnpvb20iLCBudWxsKTsKCgoKICAgICAgICAgICAgLy/ljZXlh7vmlLnlj5joioLngrnpopzoibIg6KGo5piO6YCJ5LitCiAgICAgICAgICAgIGZ1bmN0aW9uIGNsaWNrU3R5bGUobm9kZSwgaSwgX3RoaXMpewoKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF90aGlzLmlmQ2xpY2tlZCk7CiAgICAgICAgICAgICAgICAvLyBfdGhpcy5pZkNsaWNrZWQgPSB0cnVlOwoKCiAgICAgICAgICAgICAgICBjaXJjbGVfZy5hdHRyKCdub2RlJywgZnVuY3Rpb24obikgewoKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xpY2sgY2hhbmdlIGNvbG9yJyxuLmlkLG5vZGUuaWQpOwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWxlY3RlZCBub2RlJyxuLmluZGV4LG5vZGUuaW5kZXgpOwoKICAgICAgICAgICAgICAgICAgICBpZihuLmluZGV4ID09PSBub2RlLmluZGV4ICYmIF90aGlzLmlmQ2xpY2tlZD09PWZhbHNlICkgewogICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoJy5nX2NpcmNsZV8nKyBuLmluZGV4KS5zZWxlY3QoJ2NpcmNsZScpLnN0eWxlKCdmaWxsJywncmVkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOaciemXrumimO+8ge+8ge+8ge+8ge+8ge+8ge+8gQogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaGFoYScsZDMuc2VsZWN0KCcuZ19jaXJjbGVfJysgbi5pbmRleCkuc2VsZWN0KCdjaXJjbGUnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmlmQ2xpY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmlrDpgInnmoQgdHJ1ZScsX3RoaXMuaWZDbGlja2VkKTsKCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYobi5pbmRleCA9PT0gbm9kZS5pbmRleCAmJiBfdGhpcy5pZkNsaWNrZWQ9PT10cnVlICkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCgnLmdfY2lyY2xlXycrIG4uaW5kZXgpLnNlbGVjdCgnY2lyY2xlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBnZXRDaXJjbGVDb2xvcihub2RlKTt9KTsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaWZDbGlja2VkID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfph43lpI3pgInnmoTpopzoibLlj5jlm57ljrsgZmFsc2UnLF90aGlzLmlmQ2xpY2tlZCk7CgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKG4uaW5kZXggIT09IG5vZGUuaW5kZXgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25vZGUgYXJlIGRpZmZlcmVudCcpOwogICAgICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoJy5nX2NpcmNsZV8nKyBuLmluZGV4KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLnNlbGVjdCgnY2lyY2xlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZmlsbCcsIGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBnZXRDaXJjbGVDb2xvcihub2RlKTt9KQoKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQoKCgoKICAgICAgICAgICAgLy/lnIblnIgKICAgICAgICAgICAgbGV0IGNpcmNsZSA9IGNpcmNsZV9nLmFwcGVuZCgiY2lyY2xlIikKICAgICAgICAgICAgICAgIC5zdHlsZSgic3Ryb2tlLXdpZHRoIiwgIjJweCIpCiAgICAgICAgICAgICAgICAuYXR0cigiciIsIDMwKS8v6K6+572u5ZyG5ZyI5Y2K5b6ECiAgICAgICAgICAgICAgICAuc3R5bGUoImZpbGwiLCBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gZ2V0Q2lyY2xlQ29sb3Iobm9kZSk7IH0pOwoKICAgICAgICAgICAgbGV0IHRleHQgPSBjaXJjbGVfZy5hcHBlbmQoInRleHQiKQogICAgICAgICAgICAgICAgLmF0dHIoImR5IiwgIi4zNWVtIikKICAgICAgICAgICAgICAgIC5hdHRyKCJ0ZXh0LWFuY2hvciIsICJtaWRkbGUiKS8v5Zyo5ZyG5ZyI5Lit5Yqg5LiK5pWw5o2uCiAgICAgICAgICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAiI0ZGRkZGRiIpCiAgICAgICAgICAgICAgICAuYXR0cigneCcsZnVuY3Rpb24oZCl7IGFwcGVuZENpcmNsZVRleHQoZCwgdGhpcyk7IH0pOwoKICAgICAgICAgICAgLy/lnIblnIjnmoTmj5DnpLrmloflrZcKICAgICAgICAgICAgY2lyY2xlLmFwcGVuZCgic3ZnOnRpdGxlIikudGV4dChmdW5jdGlvbihub2RlKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKG5vZGUudHlwZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ25vZGUnOiByZXR1cm4gbm9kZS5wcm9wZXJ0aWVzLm5hbWU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnRGV2aWNlJzogcmV0dXJuIG5vZGUuZmFjdG9yeUNvZGU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnQXBwbGljYXRpb24nOiByZXR1cm4gbm9kZS5hcHBsaWNhdGlvbk5hbWU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnUG9zaXRpb24nOiByZXR1cm4gbm9kZS5wb3NpdGlvbkNvZGU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnTWFudWZhY3R1cmVyJzogcmV0dXJuIG5vZGUubWFudWZhY3R1cmVyTmFtZTsKICAgICAgICAgICAgICAgICAgICAvLyBjYXNlICdJb3RJbmZyYXN0cnVjdHVyZSc6IHJldHVybiBub2RlLmlvdEluZnJhc3RydWN0dXJlTmFtZTsKICAgICAgICAgICAgICAgICAgICAvLyBjYXNlICdEZXZpY2VBZG1pbic6IHJldHVybiBub2RlLm5hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0ZXh0LmFwcGVuZCgic3ZnOnRpdGxlIikudGV4dChmdW5jdGlvbihub2RlKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKG5vZGUudHlwZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ25vZGUnOiByZXR1cm4gbm9kZS5wcm9wZXJ0aWVzLm5hbWU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnRGV2aWNlJzogcmV0dXJuIG5vZGUuZmFjdG9yeUNvZGU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnQXBwbGljYXRpb24nOiByZXR1cm4gbm9kZS5hcHBsaWNhdGlvbk5hbWU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnUG9zaXRpb24nOiByZXR1cm4gbm9kZS5wb3NpdGlvbkNvZGU7CiAgICAgICAgICAgICAgICAgICAgLy8gY2FzZSAnTWFudWZhY3R1cmVyJzogcmV0dXJuIG5vZGUubWFudWZhY3R1cmVyTmFtZTsKICAgICAgICAgICAgICAgICAgICAvLyBjYXNlICdJb3RJbmZyYXN0cnVjdHVyZSc6IHJldHVybiBub2RlLmlvdEluZnJhc3RydWN0dXJlTmFtZTsKICAgICAgICAgICAgICAgICAgICAvLyBjYXNlICdEZXZpY2VBZG1pbic6IHJldHVybiBub2RlLm5hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvL+iuvue9rui/nuaOpee6vwogICAgICAgICAgICBsZXQgZGVmcyA9IHN2Zy5hcHBlbmQoImRlZnMiKTsKCiAgICAgICAgICAgIGRlZnMuYXBwZW5kKCJtYXJrZXIiKQogICAgICAgICAgICAgICAgLmF0dHIoImlkIiwgImVuZCIpCiAgICAgICAgICAgICAgICAuYXR0cigibWFya2VyVW5pdHMiLCJzdHJva2VXaWR0aCIpLy/orr7nva7kuLpzdHJva2VXaWR0aOeureWktOS8mumaj+edgOe6v+eahOeyl+e7huWPkeeUn+WPmOWMlgogICAgICAgICAgICAgICAgLmF0dHIoIm1hcmtlclVuaXRzIiwgInVzZXJTcGFjZU9uVXNlIikKICAgICAgICAgICAgICAgIC5hdHRyKCJtYXJrZXJXaWR0aCIsIDIwKS8v5qCH6K+G55qE5aSn5bCPCiAgICAgICAgICAgICAgICAuYXR0cigibWFya2VySGVpZ2h0IiwgMjApCiAgICAgICAgICAgICAgICAuYXR0cigidmlld0JveCIsICIwIC00IDEyIDE1IikvL+WdkOagh+ezu+eahOWMuuWfnwogICAgICAgICAgICAgICAgLmF0dHIoInJlZlgiLCAwKS8v566t5aS05Z2Q5qCHCiAgICAgICAgICAgICAgICAuYXR0cigicmVmWSIsIDApCiAgICAgICAgICAgICAgICAuYXR0cigib3JpZW50IiwgJ2F1dG8nKS8v57uY5Yi25pa55ZCR77yM5Y+v6K6+5a6a5Li677yaYXV0b++8iOiHquWKqOehruiupOaWueWQke+8ieWSjCDop5LluqblgLwKICAgICAgICAgICAgICAgIC5hcHBlbmQoInN2ZzpwYXRoIikKICAgICAgICAgICAgICAgIC5hdHRyKCJzdHJva2Utd2lkdGgiLDUpLy/nrq3lpLTlrr3luqYKICAgICAgICAgICAgICAgIC5hdHRyKCJkIiwgIk0wLC01TDEwLDBMMCw1IikvL+eureWktOeahOi3r+W+hAogICAgICAgICAgICAgICAgLmF0dHIoJ2ZpbGwnLCAncmdiYSgwLDAsMCwgMC40KScpOy8v566t5aS06aKc6ImyCgogICAgICAgICAgICBkZWZzLmFwcGVuZCgibWFya2VyIikKICAgICAgICAgICAgICAgIC5hdHRyKCJpZCIsICJzdGFydCIpCiAgICAgICAgICAgICAgICAuYXR0cigibWFya2VyVW5pdHMiLCJzdHJva2VXaWR0aCIpLy/orr7nva7kuLpzdHJva2VXaWR0aOeureWktOS8mumaj+edgOe6v+eahOeyl+e7huWPkeeUn+WPmOWMlgogICAgICAgICAgICAgICAgLmF0dHIoIm1hcmtlclVuaXRzIiwgInVzZXJTcGFjZU9uVXNlIikKICAgICAgICAgICAgICAgIC5hdHRyKCJtYXJrZXJXaWR0aCIsIDIwKS8v5qCH6K+G55qE5aSn5bCPCiAgICAgICAgICAgICAgICAuYXR0cigibWFya2VySGVpZ2h0IiwgMjApCiAgICAgICAgICAgICAgICAuYXR0cigidmlld0JveCIsICIwIC00IDEyIDE1IikvL+WdkOagh+ezu+eahOWMuuWfnwogICAgICAgICAgICAgICAgLmF0dHIoInJlZlgiLCAwKS8v566t5aS05Z2Q5qCHCiAgICAgICAgICAgICAgICAuYXR0cigicmVmWSIsIDApCiAgICAgICAgICAgICAgICAuYXR0cigib3JpZW50IiwgJ2F1dG8nKS8v57uY5Yi25pa55ZCR77yM5Y+v6K6+5a6a5Li677yaYXV0b++8iOiHquWKqOehruiupOaWueWQke+8ieWSjCDop5LluqblgLwKICAgICAgICAgICAgICAgIC5hcHBlbmQoInN2ZzpwYXRoIikKICAgICAgICAgICAgICAgIC5hdHRyKCJzdHJva2Utd2lkdGgiLDUpLy/nrq3lpLTlrr3luqYKICAgICAgICAgICAgICAgIC5hdHRyKCJkIiwgIk0wLDBMMTAsLTVMMTAsNSIpLy/nrq3lpLTnmoTot6/lvoQKICAgICAgICAgICAgICAgIC5hdHRyKCdmaWxsJywgJ3JnYmEoMCwwLDAsIDIpJyk7Ly/nrq3lpLTpopzoibIKCiAgICAgICAgICAgIGNvbnN0IGVkZ2VzX2xpbmUgPSBzdmcuYXBwZW5kKCJnIikuc2VsZWN0QWxsKCIuZWRnZXBhdGgiKQogICAgICAgICAgICAgICAgLmRhdGEoZm9yY2UubGlua3MoKSkKICAgICAgICAgICAgICAgIC5lbnRlcigpCiAgICAgICAgICAgICAgICAuYXBwZW5kKCJwYXRoIikKCiAgICAgICAgICAgICAgICAvLyAuYXR0cignbWFya2VyLWVuZCcsIGZ1bmN0aW9uKGQsaSkgewogICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCdsYWxhJyxkLmxhYmVsLGQueF9zdGFydCkKICAgICAgICAgICAgICAgIC8vICAgICBpZiAoZC54X3N0YXJ0IDwgZC54X2VuZCkgewogICAgICAgICAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZygnc291cmNlIDwgZW5kJykKICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuICAidXJsKCNlbmQpIjsKICAgICAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuICcnCiAgICAgICAgICAgICAgICAvLyB9KQogICAgICAgICAgICAgICAgLy8gLmF0dHIoJ21hcmtlci1zdGFydCcsIGZ1bmN0aW9uKGQsaSkgewogICAgICAgICAgICAgICAgLy8gICAgIGlmIChkLnhfc3RhcnQgPj0gZC54X2VuZCkgewogICAgICAgICAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZygnc291cmNlID4gZW5kJykKICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuICJ1cmwoI3N0YXJ0KSI7CiAgICAgICAgICAgICAgICAvLyAgICAgfQogICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiAnJwogICAgICAgICAgICAgICAgLy8KICAgICAgICAgICAgICAgIC8vIH0pCiAgICAgICAgICAgICAgICAvLyAuYXR0cigibWFya2VyLXN0YXJ0IiwgInVybCgjc3RhcnQpIikKICAgICAgICAgICAgICAgIC8vIC5hdHRyKCJtYXJrZXItZW5kIiwgIGZ1bmN0aW9uIChkLCBpKSB7IHJldHVybiBnZXRNYXJrZXJBcnJvdyhpKTsgfSkvL+agueaNrueureWktOagh+iusOeahGlk5Y+35qCH6K6w566t5aS0CiAgICAgICAgICAgICAgICAvLyAuYXR0cigibWFya2VyLWVuZCIsICApLy/moLnmja7nrq3lpLTmoIforrDnmoRpZOWPt+agh+iusOeureWktAogICAgICAgICAgICAgICAgLnN0eWxlKCJzdHJva2UiLCAnYmxhY2snKQogICAgICAgICAgICAgICAgLnN0eWxlKCJzdHJva2Utd2lkdGgiLCAzKS8v57q/5p2h57KX57uGCiAgICAgICAgICAgICAgICAuc3R5bGUoImZpbGwtb3BhY2l0eSIsMCkKICAgICAgICAgICAgICAgIC5zdHlsZSgiY3Vyc29yIiwicG9pbnRlciIpCiAgICAgICAgICAgICAgICAuYXR0cigiaWQiLCBmdW5jdGlvbiAoZCwgaSkgeyByZXR1cm4gJ2VkZ2VwYXRoJyArIGk7IH0pCiAgICAgICAgICAgICAgICAub24oIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKGQpeyByZXR1cm4gZ2V0U3Ryb2tlV2lkdGgoZCk7IH0pCiAgICAgICAgICAgICAgICAub24oIm1vdXNlb3V0IiwgZnVuY3Rpb24oKSB7IGVkZ2VzX2xpbmUuc3R5bGUoInN0cm9rZS13aWR0aCIsIDMpIH0pCiAgICAgICAgICAgICAgICAvLyAub24oJ2NsaWNrJywgKGxpbmspID0+IHsgdGhpcy5kZWxldGVMaW5lKHRoaXMuaW5mbyxsaW5rKTsgfSkKICAgICAgICAgICAgICAgIC5vbignY29udGV4dG1lbnUnLChkLGxpbmspPT57CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZCk7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xpbmshISEnLGxpbmspCiAgICAgICAgICAgICAgICAgICAgTWVudSh0aGlzLm1lbnVfZWRnZSkoZCxkMy5ldmVudCxsaW5rKQoKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY29uc3QgZWRnZXNfdGV4dCA9IHN2Zy5hcHBlbmQoImciKS5zZWxlY3RBbGwoIi5lZGdldGV4dCIpCiAgICAgICAgICAgICAgICAuZGF0YShsaW5rcykKICAgICAgICAgICAgICAgIC5lbnRlcigpCiAgICAgICAgICAgICAgICAuYXBwZW5kKCJ0ZXh0IikKICAgICAgICAgICAgICAgIC5zdHlsZSgicG9pbnRlci1ldmVudHMiLCAibm9uZSIpCiAgICAgICAgICAgICAgICAuYXR0cigiY2xhc3MiLCJsaW5ldGV4dCIpCiAgICAgICAgICAgICAgICAuYXR0cigndGV4dC1hbmNob3InLCAibWlkZGxlIikKICAgICAgICAgICAgICAgIC5hdHRyKCJmaWxsLW9wYWNpdHkiLCAwLjUpCiAgICAgICAgICAgICAgICAuc3R5bGUoImN1cnNvciIsInBvaW50ZXIiKQoKICAgICAgICAgICAgICAgIC5hdHRyKHsnY2xhc3MnOiAnZWRnZWxhYmVsJywKICAgICAgICAgICAgICAgICAgICAnaWQnOiBmdW5jdGlvbiAoZCwgaSkgeyByZXR1cm4gJ2VkZ2VwYXRoJyArIGk7IH0sCiAgICAgICAgICAgICAgICAgICAgJ2R4JzogMTkwLCAnZHknOiAyMCwKICAgICAgICAgICAgICAgICAgICAnZmlsbCc6J2JsYWNrJywKICAgICAgICAgICAgICAgICAgICAvLyAndHJhbnNmb3JtJzogZWRnZV90ZXh0X1Bvc2l0aW9uKCkKICAgICAgICAgICAgICAgIH0pOwoKCgogICAgICAgICAgICBmdW5jdGlvbiBlZGdlX3RleHRfUG9zaXRpb24oKXsKCiAgICAgICAgICAgICAgICByZXR1cm4gJ3JvdGF0ZSgxODAsNDAsNSknCiAgICAgICAgICAgIH0KCgoKICAgICAgICAgICAgLy/orr7nva7nur/mnaHkuIrnmoTmloflrZcKICAgICAgICAgICAgZWRnZXNfdGV4dC5hcHBlbmQoJ3RleHRQYXRoJykKICAgICAgICAgICAgICAgIC5hdHRyKCd4bGluazpocmVmJywgZnVuY3Rpb24gKGQsIGkpIHsgcmV0dXJuICcjZWRnZXBhdGgnICsgaSB9KQogICAgICAgICAgICAgICAgLmF0dHIoInBvaW50ZXItZXZlbnRzIiwgIm5vbmUiKQogICAgICAgICAgICAgICAgLmF0dHIoImZvbnQtc2l6ZSIsIDIwKQogICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQubGFiZWw7IH0pOwoKCgogICAgICAgICAgICAvLyBmb3JjZS5vbigidGljayIsIHRpY2spLy/mjIfml7bpl7Tpl7TpmpTvvIzpmpTkuIDmrrXml7bpl7TliLfmlrDkuIDmrKHnlLvpnaIKICAgICAgICAgICAgLy8gICAgIC5zdGFydCgpOy8v5byA5aeL6L2s5o2iCiAgICAgICAgICAgIGZ1bmN0aW9uIHpvb21lZCgpIHsvL3N2Z+S4i+eahGfmoIfnrb7np7vliqjlpKflsI8KICAgICAgICAgICAgICAgIHN2Zy5zZWxlY3RBbGwoImciKS5hdHRyKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKCIgICtkMy5ldmVudC50cmFuc2xhdGUgKyAiKXNjYWxlKCIgK2QzLmV2ZW50LnNjYWxlICsgIikiKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gZ2V0TWFya2VyQXJyb3coaSkgewogICAgICAgICAgICAgICAgc3ZnLmFwcGVuZCgiZGVmcyIpLmFwcGVuZCgibWFya2VyIikgICAvL+eureWktAogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJpZCIsICJhcnJvdyIraSkKICAgICAgICAgICAgICAgICAgICAuYXR0cigibWFya2VyVW5pdHMiLCJzdHJva2VXaWR0aCIpLy/orr7nva7kuLpzdHJva2VXaWR0aOeureWktOS8mumaj+edgOe6v+eahOeyl+e7huWPkeeUn+WPmOWMlgogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJtYXJrZXJVbml0cyIsICJ1c2VyU3BhY2VPblVzZSIpCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoIm1hcmtlcldpZHRoIiwgMjApLy/moIfor4bnmoTlpKflsI8KICAgICAgICAgICAgICAgICAgICAuYXR0cigibWFya2VySGVpZ2h0IiwgMjApCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoInZpZXdCb3giLCAiMCAtNCAxMiAxNSIpLy/lnZDmoIfns7vnmoTljLrln58KICAgICAgICAgICAgICAgICAgICAuYXR0cigicmVmWCIsIDApLy/nrq3lpLTlnZDmoIcKICAgICAgICAgICAgICAgICAgICAuYXR0cigicmVmWSIsIDApCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoIm9yaWVudCIsICdhdXRvJykvL+e7mOWItuaWueWQke+8jOWPr+iuvuWumuS4uu+8mmF1dG/vvIjoh6rliqjnoa7orqTmlrnlkJHvvInlkowg6KeS5bqm5YC8CiAgICAgICAgICAgICAgICAgICAgLmFwcGVuZCgic3ZnOnBhdGgiKQogICAgICAgICAgICAgICAgICAgIC5hdHRyKCJzdHJva2Utd2lkdGgiLDUpLy/nrq3lpLTlrr3luqYKICAgICAgICAgICAgICAgICAgICAuYXR0cigiZCIsICJNMCwtNUwxMCwwTDAsNSIpLy/nrq3lpLTnmoTot6/lvoQKICAgICAgICAgICAgICAgICAgICAuYXR0cignZmlsbCcsICdyZ2JhKDAsMCwwLCAwLjQpJyk7Ly/nrq3lpLTpopzoibIKICAgICAgICAgICAgICAgIHJldHVybiAidXJsKCNhcnJvd19lbmQiICsgaSArICIpIjsKICAgICAgICAgICAgfQoKCgogICAgICAgICAgICBmdW5jdGlvbiBnZXRTdHJva2VXaWR0aChkKSB7CiAgICAgICAgICAgICAgICBlZGdlc19saW5lLnN0eWxlKCJzdHJva2Utd2lkdGgiLCBmdW5jdGlvbiAoZWRnZSkgewogICAgICAgICAgICAgICAgICAgIC8vIHJldHVybiBlZGdlLnJlbGF0aW9uLnJlbGF0aW9uc2hpcElkID09PSBkLnJlbGF0aW9uLnJlbGF0aW9uc2hpcElkID8gMyA6IDE7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDYKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBkcmFnKCl7Ly/mi5bmi73lh73mlbAKICAgICAgICAgICAgICAgIHJldHVybiBmb3JjZS5kcmFnKCkub24oImRyYWdzdGFydCIsZnVuY3Rpb24oZCl7CiAgICAgICAgICAgICAgICAgICAgZDMuZXZlbnQuc291cmNlRXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7IC8v5Y+W5raI6buY6K6k5LqL5Lu2CiAgICAgICAgICAgICAgICAgICAgZC5maXhlZCA9IHRydWU7Ly/mi5bmi73lvIDlp4vlkI7orr7lrprooqvmi5bmi73lr7nosaHkuLrlm7rlrpoKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBnZXRDaXJjbGVDb2xvcihub2RlKSB7CiAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSB7CiAgICAgICAgICAgICAgICAgICAgJ0RldmljZSc6ICIjRkY5RDAwIiwKICAgICAgICAgICAgICAgICAgICAnUG9zaXRpb24nOiAiI0M0NzdFOSIsCiAgICAgICAgICAgICAgICAgICAgJ1dvcmsnOiAnIzY3Q0FGNCcsCiAgICAgICAgICAgICAgICAgICAgJ0luc3RhbGwnOiAnI0JDREQ3MycsCiAgICAgICAgICAgICAgICAgICAgJ0FwcGxpY2F0aW9uJzogJyNERDFFOUUnLAogICAgICAgICAgICAgICAgICAgICdNYW51ZmFjdHVyZXInOiAnI0REQkE5RScsCiAgICAgICAgICAgICAgICAgICAgJ0lvdEluZnJhc3RydWN0dXJlJzogJyM2Y2E1ZGQnLAogICAgICAgICAgICAgICAgICAgICdEZXZpY2VBZG1pbic6ICcjNTBERDg3JywKICAgICAgICAgICAgICAgIH07Ly/lnIblnIjog4zmma/oibIKICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcltub2RlLmxhYmVsXSB8fCAnI0M0NzdFOSc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIGFwcGVuZENpcmNsZVRleHQoZCwgX3RoaXMpIHsKICAgICAgICAgICAgICAgIGxldCBjaXJjbGVUZXh0ID0gJyc7CiAgICAgICAgICAgICAgICBpZihkLnR5cGUgPT09ICdub2RlJyAmJiBkLnByb3BlcnRpZXMubmFtZSkgewogICAgICAgICAgICAgICAgICAgIGNpcmNsZVRleHQgPSBkLnByb3BlcnRpZXMubmFtZTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZihkLmxhYmVsID09PSAnUG9zaXRpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgY2lyY2xlVGV4dCA9IGQucG9zaXRpb25Db2RlOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLmxhYmVsID09PSAnQXBwbGljYXRpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgY2lyY2xlVGV4dCA9IGQuYXBwbGljYXRpb25OYW1lOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkLmxhYmVsID09PSAnTWFudWZhY3R1cmVyJykgewogICAgICAgICAgICAgICAgICAgIGNpcmNsZVRleHQgPSBkLm1hbnVmYWN0dXJlck5hbWU7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQubGFiZWwgPT09ICdJb3RJbmZyYXN0cnVjdHVyZScpIHsKICAgICAgICAgICAgICAgICAgICBjaXJjbGVUZXh0ID0gZC5pb3RJbmZyYXN0cnVjdHVyZU5hbWU7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGQubGFiZWwgPT09ICdEZXZpY2VBZG1pbicpIHsKICAgICAgICAgICAgICAgICAgICBjaXJjbGVUZXh0ID0gZC5uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy/lpoLmnpzlsI/kuo7lm5vkuKrlrZfnrKbvvIzkuI3mjaLooYwKICAgICAgICAgICAgICAgIGlmKGNpcmNsZVRleHQgJiYgY2lyY2xlVGV4dC5sZW5ndGggPiAxNCl7CiAgICAgICAgICAgICAgICAgICAgY2lyY2xlVGV4dCA9IGNpcmNsZVRleHQuc3Vic3RyaW5nKDAsMTQpICsgIi4uLiI7CiAgICAgICAgICAgICAgICAgICAgZDMuc2VsZWN0KF90aGlzKS50ZXh0KGZ1bmN0aW9uKCl7cmV0dXJuICcnO30pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZDMuc2VsZWN0KF90aGlzKS5hcHBlbmQoJ3RzcGFuJykuYXR0cigneCcsMCkuYXR0cigneScsMCkuYXR0cigiZm9udC1zaXplIiwgMTApCiAgICAgICAgICAgICAgICAgICAgLnRleHQoZnVuY3Rpb24oKXsgcmV0dXJuIGNpcmNsZVRleHQ7IH0pOwogICAgICAgICAgICB9CgoKCgoKCiAgICAgICAgICAgIGZ1bmN0aW9uIHRpY2soKSB7CgogICAgICAgICAgICAgICAgY2lyY2xlLmF0dHIoInRyYW5zZm9ybSIsIHRyYW5zZm9ybTEpOy8v5ZyG5ZyICiAgICAgICAgICAgICAgICB0ZXh0LmF0dHIoInRyYW5zZm9ybSIsIHRyYW5zZm9ybTIpOy8v6aG254K55paH5a2XCiAgICAgICAgICAgICAgICAvL2xpbmvlpYfmlbDmnInpl67popgKICAgICAgICAgICAgICAgIGVkZ2VzX2xpbmUKICAgICAgICAgICAgICAgICAgICAuYXR0cignZCcsIGZ1bmN0aW9uIChkKSB7CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXROb2Rlc0xpbmUoZCxlZGdlc19saW5lLGRlZnMpOy8v5puy57q/6Lev5b6ECgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBlZGdlc19saW5lLmF0dHIoJ21hcmtlci1lbmQnLCBmdW5jdGlvbihkLGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQueF9zdGFydCA8IGQueF9lbmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdzb3VyY2UgPCBlbmQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAidXJsKCNlbmQpIjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycKICAgICAgICAgICAgICAgICAgICB9KS5hdHRyKCdtYXJrZXItc3RhcnQnLCBmdW5jdGlvbihkLGkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZC54X3N0YXJ0ID49IGQueF9lbmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ3NvdXJjZSA+IGVuZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAidXJsKCNzdGFydCkiOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gJycKCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgOwoKCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8v6K6+572u5ZyG5ZyI5ZKM5paH5a2X55qE5Z2Q5qCHCiAgICAgICAgICAgIGZ1bmN0aW9uIHRyYW5zZm9ybTEoZCkgewogICAgICAgICAgICAgICAgcmV0dXJuICJ0cmFuc2xhdGUoIiArIGQueCArICIsIiArIGQueSArICIpIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gdHJhbnNmb3JtMihkKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gInRyYW5zbGF0ZSgiICsgKGQueCkgKyAiLCIgKyBkLnkgKyAiKSI7CiAgICAgICAgICAgIH0KCgoKICAgICAgICAgICAgZnVuY3Rpb24gTWVudSAobWVudSwgb3BlbkNhbGxiYWNrKSB7CgogICAgICAgICAgICAgICAgZDMuZXZlbnQucHJldmVudERlZmF1bHQoKTsKCiAgICAgICAgICAgICAgICBkMy5zZWxlY3RBbGwoJy5kMy1jb250ZXh0LW1lbnUnKS5kYXRhKFsxXSkKICAgICAgICAgICAgICAgICAgICAuZW50ZXIoKQogICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ2RpdicpCiAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2QzLWNvbnRleHQtbWVudScpCgogICAgICAgICAgICAgICAgLy8gY2xvc2UgbWVudQogICAgICAgICAgICAgICAgZDMuc2VsZWN0KCdib2R5Jykub24oJ2NsaWNrLmQzLWNvbnRleHQtbWVudScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3QoJy5kMy1jb250ZXh0LW1lbnUnKS5zdHlsZSgnZGlzcGxheScsICdub25lJykKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIHJldHVybiAoc2VsZWN0LCBldmVudCwgZGF0YSk9PiB7CgoKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxlY3QudHlwZSk7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbGVjdCcsZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGVsbSA9IHRoaXM7CgoKICAgICAgICAgICAgICAgICAgICBkMy5zZWxlY3RBbGwoJy5kMy1jb250ZXh0LW1lbnUnKS5odG1sKCcnKTsKICAgICAgICAgICAgICAgICAgICBsZXQgbGlzdCA9IGQzLnNlbGVjdEFsbCgnLmQzLWNvbnRleHQtbWVudScpLmFwcGVuZCgndWwnKTsKCiAgICAgICAgICAgICAgICAgICAgbGlzdC5zZWxlY3RBbGwoJ2xpJykuZGF0YShtZW51KS5lbnRlcigpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJ2xpJykKICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoZnVuY3Rpb24gKGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnRpdGxlCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbiAoZCkgewoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLmFjdGlvbihkYXRhLCBzZWxlY3QpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCgnLmQzLWNvbnRleHQtbWVudScpLnN0eWxlKCdkaXNwbGF5JywgJ25vbmUnKQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG9wZW5DYWxsYmFjayBhbGxvd3MgYW4gYWN0aW9uIHRvIGZpcmUgYmVmb3JlIHRoZSBtZW51IGlzIGRpc3BsYXllZAogICAgICAgICAgICAgICAgICAgIC8vIGFuIGV4YW1wbGUgdXNhZ2Ugd291bGQgYmUgY2xvc2luZyBhIHRvb2x0aXAKICAgICAgICAgICAgICAgICAgICBpZiAob3BlbkNhbGxiYWNrKSBvcGVuQ2FsbGJhY2soZGF0YSk7CgogICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXkgY29udGV4dCBtZW51CgogICAgICAgICAgICAgICAgICAgIGQzLnNlbGVjdCgnLmQzLWNvbnRleHQtbWVudScpCiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnbGVmdCcsIChldmVudC5wYWdlWCAtIDIpICsgJ3B4JykKICAgICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKCd0b3AnLCAoZXZlbnQucGFnZVkgLSAyKSArICdweCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnZGlzcGxheScsICdibG9jaycpOwogICAgICAgICAgICAgICAgICAgIGQzLmV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICAgICAgLy8gcmV0dXJuIGZhbHNlCiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9CgoKICAgICAgICB9LAoKICAgICAgICBkb3VibGVDbGljayhpbmZvLG5vZGVzLCBpbnB1dCl7CgoKICAgICAgICAgICAgbGV0IG5ld19ub2RlID0gewogICAgICAgICAgICAgICAgJ2lkJzogbm9kZXMubGVuZ3RoLAogICAgICAgICAgICAgICAgInR5cGUiOiAibm9kZSIsCiAgICAgICAgICAgICAgICAncHJvcGVydGllcyc6IHsnbmFtZSc6IGlucHV0fQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgY29uc29sZS5sb2coJzYuIGFkZCBub2RlJyk7CiAgICAgICAgICAgIGluZm8ubm9kZXMucHVzaChuZXdfbm9kZSk7CiAgICAgICAgICAgIHRoaXMucmVuZGVyR3JhcGgoaW5mbyk7CgoKICAgICAgICB9LAoKICAgICAgICBzaW5nbGVDbGljayhpbmZvLCBub2RlLGlucHV0KXsKICAgICAgICAgICAgLy8gbGV0IHRlbXAgPSBbXTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ3NpbmdsZSBjbGljayEnKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJ25vZGUgaWQnLCBub2RlKTsKICAgICAgICAgICAgLy8gbGV0IHNvdXJjZSA9IG5vZGUuaWQ7CgoKICAgICAgICAgICAgaWYodGhpcy50ZW1wLmxlbmd0aCA9PT0yICYmIHRoaXMudGVtcFswXSAhPT0gdGhpcy50ZW1wWzFdICkKICAgICAgICAgICAgewoKCiAgICAgICAgICAgICAgICBsZXQgbmV3X2xpbmsgPSB7CiAgICAgICAgICAgICAgICAgICAgInNvdXJjZSI6IHRoaXMudGVtcFswXSwKICAgICAgICAgICAgICAgICAgICAidGFyZ2V0IjogdGhpcy50ZW1wWzFdLAogICAgICAgICAgICAgICAgICAgICJ0eXBlIjogJ2xpbmsnLAogICAgICAgICAgICAgICAgICAgICJwcm9wZXJ0aWVzIjoge30sCiAgICAgICAgICAgICAgICAgICAgImxhYmVsIjogaW5wdXQKCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIGluZm8ubGlua3MucHVzaChuZXdfbGluayk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbmV3IGxpbmsgYWRkZWQnLCBpbmZvLmxpbmtzKTsKICAgICAgICAgICAgICAgIHRoaXMudGVtcC5sZW5ndGggPSAwOwogICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJHcmFwaChpbmZvKQoKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKHRoaXMudGVtcC5sZW5ndGggPT09MiAmJiB0aGlzLnRlbXBbMF0gPT09IHRoaXMudGVtcFsxXSApCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHRoaXMudGVtcC5sZW5ndGggPSAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy50ZW1wLmxlbmd0aCA9PT0wKXsKICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyR3JhcGgoaW5mbykKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc29sZS5sb2coJ2N1cnJlbnQgc2VsZWN0IG5vZGUgaWQnLHRoaXMudGVtcCkKCgogICAgICAgIH0sCgoKICAgICAgICBzdWJtaXREYXRhKCl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdWJtaXQgZGF0YScsdGhpcy5pbmZvKTsKCiAgICAgICAgICAgIGFsZXJ0KCdTdWJtaXQgU3VjY2Vzc2Z1bGx5IScpOwogICAgICAgICAgICBjb25zb2xlLmxvZygnY3VycmVudCB1c2VyJywgdGhpcy5jdXJyZW50X3VzZXIpOwogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmluZm8ubm9kZXMpOwogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmluZm8ubGlua3MpOwoKICAgICAgICAgICAgdGhpcy51cGxvYWRfbm9kZXMgPSB0aGlzLmluZm8ubm9kZXMubWFwKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgICAgICAgICByZXR1cm4geyAiaWQiOlN0cmluZyhlbGVtZW50LmlkKSwidHlwZSI6IGVsZW1lbnQudHlwZSwibGFiZWwiOiBlbGVtZW50LmxhYmVsLCAicHJvcGVydGllcyI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiBlbGVtZW50LnByb3BlcnRpZXMubmFtZQogICAgICAgICAgICAgICAgICAgIH19CgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8KICAgICAgICAgICAgdGhpcy51cGxvYWRfbGlua3MgPSB0aGlzLmluZm8ubGlua3MubWFwKGZ1bmN0aW9uIChlbGVtZW50KSB7CgogICAgICAgICAgICAgICAgcmV0dXJuIHsidHlwZSI6ZWxlbWVudC50eXBlLCAiaWQiOlN0cmluZyhlbGVtZW50LmlkKSwgImxhYmVsIjogZWxlbWVudC5sYWJlbCwKICAgICAgICAgICAgICAgICAgICAic291cmNlIjpTdHJpbmcoZWxlbWVudC5zb3VyY2UuaWQpLCAidGFyZ2V0IjpTdHJpbmcoZWxlbWVudC50YXJnZXQuaWQpLAogICAgICAgICAgICAgICAgICAgICJwcm9wZXJ0aWVzIjplbGVtZW50LnByb3BlcnRpZXN9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAvLwogICAgICAgICAgICBjb25zb2xlLmxvZygnbm4nLEpTT04uc3RyaW5naWZ5KHRoaXMudXBsb2FkX25vZGVzKSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdubicsSlNPTi5zdHJpbmdpZnkodGhpcy51cGxvYWRfbGlua3MpKTsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2xsJyx1cGxvYWRfbGlua3MpOwoKCgogICAgICAgICAgICB0aGlzLiRheGlvcyh7CiAgICAgICAgICAgICAgICBoZWFkZXJzOnsKICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb247JwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHVybDonL3Bvc3RVc2VyR3JhcGgnLAogICAgICAgICAgICAgICAgbWV0aG9kOidwb3N0JywKICAgICAgICAgICAgICAgIGRhdGE6ewogICAgICAgICAgICAgICAgICAgIHVzZXIgOiB0aGlzLmN1cnJlbnRfdXNlciwKICAgICAgICAgICAgICAgICAgICBub2RlczogdGhpcy51cGxvYWRfbm9kZXMsCiAgICAgICAgICAgICAgICAgICAgLy8gbm9kZXM6WwogICAgICAgICAgICAgICAgICAgIC8vICAgICB7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAidHlwZSI6ICJub2RlIiwKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICJpZCI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICJsYWJlbCI6ICJDb25jZXB0IiwKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICJwcm9wZXJ0aWVzIjogewogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgICJuYW1lIjogIklubm92YXRpb24iCiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gICAgIH0sCiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICJ0eXBlIjogIm5vZGUiLAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgImlkIjogIjEiLAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgImxhYmVsIjogIkNvbmNlcHQiLAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgInByb3BlcnRpZXMiOiB7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgIm5hbWUiOiAiR2xvYmFsaXphdGlvbiIKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyAgICAgfV0sCiAgICAgICAgICAgICAgICAgICAgbGlua3M6IHRoaXMudXBsb2FkX2xpbmtzCiAgICAgICAgICAgICAgICAgICAgLy8gbGlua3M6ICBbCiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICJ0eXBlIjogImxpbmsiLAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgImlkIjogIjAiLAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgImxhYmVsIjogImJlbmVmaXRzIiwKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgICJzb3VyY2UiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgICAidGFyZ2V0IjogIjEiLAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICAgInByb3BlcnRpZXMiOiB7fQogICAgICAgICAgICAgICAgICAgIC8vICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8gXQogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgIH0pLnRoZW4ocmVzcG9uc2U9PnsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdWNjZXNzJyxyZXNwb25zZSkKICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyR3JhcGgodGhpcy5pbmZvKQogICAgICAgICAgICB9KQogICAgICAgIH0sCgogICAgICAgIHJlbG9hZCgpewogICAgICAgICAgICB0aGlzLnJlbmRlckdyYXBoKHRoaXMuaW5mbykKICAgICAgICB9LAoKICAgICAgICBkZWxldGVOb2Rlcyhub2RlLGluZm8pewogICAgICAgICAgICBjb25zb2xlLmxvZygnc2VsZWN0IGRlbGV0ZSBub2RlJyxub2RlKQogICAgICAgIH0sCgoKCgogICAgICAgIHJlbW92ZU5vZGVDbGljaygpewoKICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlbW92ZSBub2RlJykKCiAgICAgICAgfSwKCgoKCgoKCgogICAgfQoKCn0K"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8QA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;AAKA;;;AAGA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;;AAIA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;;;AAGA;AACA;;AAEA;AACA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;;;;AAKA;AACA;;;;AAIA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAOA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;;AAKA;;AAEA;;AAEA;;;;;;;;;AASA;;;AAGA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n\n\n\n\n\n    <div id=\"app\">\n        <el-row>\n            <el-header style=\"text-align: right;height: 40px;\">\n                <div class=\"grid-content \">\n                    <template >\n                        <el-button style=\"margin-right: 5px;\"  @click=\"onTapLogin\" v-show=\"showLogin\" size=\"small\" round>Login</el-button>\n                        <el-button style=\"margin-right: 5px;\" size=\"small\" type=\"success\" v-show=\"!showLogin\" round>{{username}}</el-button>\n                        <el-button  @click=\"logout\" size=\"small\" v-show=\"!showLogin\" round>Logout</el-button>\n                    </template>\n                </div>\n            </el-header>\n\n            <el-dialog\n                    title=\"Login\"\n                    :visible.sync=\"centerDialogVisible\"\n                    width=\"30%\"\n                    center>\n                <span>Username<el-input v-model=\"username\" placeholder=\"Please Input Username\"></el-input></span>\n                <br><br>\n                <span>Password<el-input type=\"password\" v-model=\"password\" placeholder=\"Please Input Password\"></el-input></span>\n                <el-button type=\"text\" style=\"margin-top: 15px;\" @click.native=\"dialog_createUser=true; centerDialogVisible=false\">No account?</el-button>\n                <span slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click.native=\"centerDialogVisible=false\">Cancel</el-button>\n            <el-button type=\"primary\" @click.native=\"handleShow\" >Yes</el-button>\n          </span>\n            </el-dialog>\n\n\n            <el-dialog\n                    title=\"Create New Account\"\n                    :visible.sync=\"dialog_createUser\"\n                    width=\"30%\"\n                    center>\n                <span>Username<el-input v-model=\"newUsername\" placeholder=\"Please Input Username\"></el-input></span>\n                <br><br>\n                <span>Password<el-input type=\"password\" v-model=\"newPassword\" onkeyup=\"value=value.replace(/[^A-Za-z0-9_]/g,'');\" placeholder=\"Please Input Password\"></el-input></span>\n                <span slot=\"footer\" class=\"dialog-footer\">\n            <el-button @click.native=\"dialog_createUser=false\">Cancel</el-button>\n            <el-button type=\"primary\" @click=\"createUser\" >Yes</el-button>\n          </span>\n            </el-dialog>\n\n\n\n\n\n        </el-row>\n\n        <el-container>\n\n            <el-row class=\"tac\">\n                <el-col >\n                    <h5>SustainKG</h5>\n                    <el-menu\n\n                            default-active=\"2\"\n                            class=\"el-menu-vertical-demo\"\n\n                    >\n                        <el-submenu index=\"1\">\n                            <template slot=\"title\">\n                                <i class=\"el-icon-location\"></i>\n                                <span>Operation</span>\n                            </template>\n                            <el-menu-item-group>\n                                <!--<template slot=\"title\">分组一</template>-->\n                                <el-menu-item index=\"1-1\" @click=\"submitData()\">Submit Data</el-menu-item>\n                                <el-menu-item index=\"1-2\" @click=\"getWikipedia()\">get Articles</el-menu-item>\n                                <el-menu-item index=\"1-3\" @click=\"reload()\">Reload Data</el-menu-item>\n                            </el-menu-item-group>\n\n\n                        </el-submenu>\n                        <el-menu-item >\n                            <i class=\"el-icon-menu\"></i>\n                            <span slot=\"title\">Node Number：{{ info.nodes.length }}</span>\n                        </el-menu-item>\n                        <el-menu-item >\n                            <i class=\"el-icon-setting\"></i>\n                            <span slot=\"title\">Link Number：{{ info.links.length }}</span>\n                        </el-menu-item>\n                    </el-menu>\n                </el-col>\n\n\n                <router-view></router-view>\n\n            </el-row>\n\n\n\n            <el-dialog :visible.sync=\"dialogFormVisible\"\n                       title=\"Create Node\" center\n            >\n\n                Node Name\n                <el-select\n\n                        @keyup.native = \"showOption\"\n                        label-position=\"right\"\n                        label-width=\"86px\"\n                        style=\"width: 300px; margin-left:50px;\"\n\n                        v-model=\"node_value\"\n                        placeholder=\"Please select\"\n                        clearable\n                        filterable\n                        @blur=\"showOption\"\n                        @clear=\"selectClear\"\n                        @change=\"selectChange\"\n                >\n                    <div  v-show=\"optionVisible\">\n                    <el-option\n\n                        v-for=\"(item,index) in node_list\"\n                        :key=\"index\"\n                        :label=\"item.label\"\n                        :value=\"item.value\" ></el-option>\n                    </div>\n                </el-select>\n\n                <div slot=\"footer\" class=\"dialog-footer\">\n                    <el-button @click=\"cancel\">\n                        No\n                    </el-button>\n                    <el-button type=\"primary\" :disabled=\"btnChangeEnable\" @click=\"addNodes\">\n                        Yes\n                    </el-button>\n                </div>\n            </el-dialog>\n\n\n            <el-dialog :visible.sync=\"dialogFormVisible_change_node_name\"\n                       title=\"Change Node Name\" center\n            >\n\n                    Node Name\n                <el-select\n\n                        @keyup.native = \"showOption\"\n                        label-position=\"right\"\n                        label-width=\"86px\"\n                        style=\"width: 300px; margin-left:30px;\"\n\n                        v-model=\"new_node_name\"\n                        placeholder=\"Please select\"\n                        clearable\n                        filterable\n                        @blur=\"showOption\"\n                        @clear=\"selectClear\"\n                        @change=\"selectChange\"\n                >\n                    <div  v-show=\"optionVisible\">\n                    <el-option\n                        v-for=\"(item,index) in node_list\"\n                        :key=\"index\"\n                        :label=\"item.label\"\n                        :value=\"item.value\" ></el-option></div>\n                </el-select>\n                <div slot=\"footer\" class=\"dialog-footer\">\n                    <el-button @click=\"cancel\">\n                        No\n                    </el-button>\n                    <el-button type=\"primary\" :disabled=\"btnChangeEnable\" @click=\"change_node_name\">\n                        Yes\n                    </el-button>\n                </div>\n            </el-dialog>\n\n\n\n            <el-dialog :visible.sync=\"dialogFormVisible_link\"\n                       :show-close=\"false\"\n                       title=\"Create Link\" center>\n\n                Link Name\n\n                <el-select\n                        @keyup.native = \"showOption_link\"\n                        label-position=\"right\"\n                        label-width=\"86px\"\n                        style=\"width: 300px; margin-left:50px;\"\n\n                        v-model=\"link_value\"\n                        placeholder=\"Please select\"\n                        clearable\n                        filterable\n                        @blur=\"showOption_link\"\n                        @clear=\"selectClear\"\n                        @change=\"selectChange\"\n                >\n                    <div  v-show=\"optionVisible_link\">\n                    <el-option\n                        v-for=\"(item,index) in link_list\"\n                        :key=\"index\"\n                        :label=\"item.label\"\n                        :value=\"item.value\" ></el-option></div>\n\n                </el-select>\n\n\n                <div slot=\"footer\" class=\"dialog-footer\">\n                    <el-button @click=\"cancel\">\n                        No\n                    </el-button>\n                    <el-button type=\"primary\" :disabled=\"btnChangeEnable\"  @click=\"addLinks\">\n                        Yes\n                    </el-button>\n                </div>\n            </el-dialog>\n\n            <el-dialog :visible.sync=\"dialogFormVisible_change_link_name\"\n                       title=\"Change Link Name\" center>\n\n                Link Name\n                <el-select\n                        @keyup.native = \"showOption_link\"\n                        label-position=\"right\"\n                        label-width=\"86px\"\n                        style=\"width: 300px; margin-left:30px;\"\n\n                        v-model=\"new_link_name\"\n                        placeholder=\"Please select\"\n                        clearable\n                        filterable\n                        @blur=\"showOption_link\"\n                        @clear=\"selectClear\"\n                        @change=\"selectChange\"\n                >\n                    <div  v-show=\"optionVisible_link\">\n                    <el-option\n                        v-for=\"(item,index) in link_list\"\n                        :key=\"index\"\n                        :label=\"item.label\"\n                        :value=\"item.value\" ></el-option></div>\n                </el-select>\n                <div slot=\"footer\" class=\"dialog-footer\">\n                    <el-button @click=\"cancel\">\n                        No\n                    </el-button>\n                    <el-button type=\"primary\" :disabled=\"btnChangeEnable\" @click=\"change_link_name\">\n                        Yes\n                    </el-button>\n                </div>\n            </el-dialog>\n\n\n            <el-main id=\"graph\">\n                <!--<div id=\"graph\"></div>-->\n            </el-main>\n\n\n\n\n        </el-container>\n\n\n\n\n    </div>\n\n</template>\n\n<script>\n    import * as d3 from \"d3\";\n    import hahaha from 'node-7z'\n\n    import $ from 'jquery'\n    import {\n        getNodeSelfPath,\n        setLinkGroup,\n        getNodesLine,} from './utils/deviceRelation'\n\n\n\n\n    export default {\n\n\n        data(){\n\n\n\n            let info = {\n                \"links\": [\n                    {\n                        \"source\" : 0,\n                        \"target\" : 1,\n                        \"type\" : \"link\",\n                        'label': 'Link TEST',\n                        \"properties\":{}\n\n                    },\n\n                ],\n                \"nodes\": [\n                    {\n                        \"id\": 0,\n                        \"type\" : \"node\",\n                        \"label\" : \"Device\",\n                        \"properties\":{\"name\":\"hello\"}\n                    },\n                    {\n                        \"id\": 1,\n                        \"type\" : \"node\",\n                        \"label\": \"Device\",\n                        \"properties\":{\"name\":\"will\"}\n                    },\n                    {\n                        \"id\": 2,\n                        \"type\" : \"node\",\n                        \"label\": \"Device\",\n                        \"properties\":{\"name\":\"lala\"}\n                    },\n\n                ]\n            };\n\n\n\n            return {\n\n                //////////////////////////////////////\n\n                // log function parameters\n                current_user:'',\n                username:'',\n                password:'',\n                newUsername:'',\n                newPassword:'',\n                showLogin:true,\n                centerDialogVisible:false,\n                dialog_createUser:false,\n                optionVisible:false,\n                optionVisible_link:false,\n                upload_nodes:'',\n                upload_links:'',\n\n\n                //////////////////////////////////////\n\n                node_value: '',\n                link_value:'',\n                btnChangeEnable: true,\n                node_list: [\n                    {\n                        value: 'node1',\n                        label: 'node1'\n                    },\n\n                    {\n                        value: 'node2',\n                        label: 'node2'\n                    },\n\n                    {\n                        value: 'test3',\n                        label: 'test3'\n                    },\n                    {\n                        value: 'bbb',\n                        label: 'bbb'\n                    }\n                ],\n\n                link_list: [\n                    {\n                        value: 'link1',\n                        label: 'link1'\n                    },\n                    {\n                        value: 'link2',\n                        label: 'link2'\n                    },\n                    {\n                        value: 'test_3',\n                        label: 'test_3'\n                    }\n                ],\n\n                info: {\n                    nodes:[],\n                    links:[]\n                },\n\n                // info: info,\n\n                ifClicked:false,\n\n                selected_Node: '',\n\n                dialogFormVisible:false,\n                dialogFormVisible_link:false,\n                dialogFormVisible_change_node_name:false,\n                dialogFormVisible_change_link_name:false,\n                temp : [],\n                clickTimeId : 0,\n\n                node_id: '',\n                link_id: '',\n                new_link_name:'',\n                new_node_name:'',\n\n                menu: [\n                    {\n                        title: 'Delete Nodes',\n                        action: (node,select_node) => {\n\n                            this.$confirm(\"Delete this node?\", \"Tips\", {\n                                confirmButtonText: \"Yes\",\n                                cancelButtonText: \"No\",\n                                type: \"warning\",\n                            }).then(() => {\n                                this.$message(\n\n                                    {\n                                        type: 'success',\n                                        message: 'The node is deleted!'\n                                    });\n                                console.log('test !!!',select_node,node);\n                                this.info.nodes.splice(node,1);\n                                for(let i =this.info.links.length-1; i>=0; i-- )\n                                {\n                                    console.log('link index',i,node);\n                                    if(this.info.links[i].source === select_node\n                                        || this.info.links[i].target === select_node)\n                                    {\n                                        this.info.links.splice(i,1);\n                                    }\n\n                                }\n\n                                console.log('after delete', this.info)\n                                this.renderGraph(this.info);\n\n                            }).catch(() => {\n                                this.$message({\n                                    type: 'info',\n                                    message: 'Cancel Delete!'\n                                })\n\n                            });\n\n                        },\n\n\n                    },\n                    {\n                        title: 'Change Node Name',\n                        action:(node_id)=>{\n                            this.dialogFormVisible_change_node_name = true;\n                            this.node_id = node_id;\n\n                        },\n\n                    },\n\n                ],\n\n                menu_edge:[\n                    {\n                        title: 'Delete Links',\n                        action: (link,selected_link) => {\n                            console.log('ll',link,selected_link);\n                            this.$confirm(\"Delete this link?\", \"Tips\", {\n                                confirmButtonText: \"Yes\",\n                                cancelButtonText: \"No\",\n                                type: \"warning\",\n                            }).then(() => {\n                                this.$message(\n\n                                    {\n                                        type: 'success',\n                                        message: 'The link is deleted!'\n                                    });\n                                this.info.links.splice(link,1);\n                                this.renderGraph(this.info);\n\n                            }).catch(() => {\n                                this.$message({\n                                    type: 'info',\n                                    message: 'Cancel Delete!'\n                                })\n\n                            });\n\n                        },\n\n                    },\n                    {\n                        title: 'Change link Name',\n                        action:(link_id)=>\n                        {\n                            this.dialogFormVisible_change_link_name = true;\n                            this.link_id = link_id;\n\n                        }\n\n                    }\n                ],\n\n\n\n            }\n        },\n\n        mounted() {\n\n            this.renderGraph(this.info);\n\n        },\n\n        methods: {\n            ////////////////////////////////////////////////////////////\n            // login functions\n\n            createUser:function(){\n\n                this.dialog_createUser  = false;\n                console.log('create user function',this.newUsername, this.newPassword)\n\n                this.$axios({\n                    url : '/createNewUser',\n                    method : 'post',\n                    data :\n                        {\n                            \"user\" : this.newUsername,\n                            \"password\" : this.newPassword\n                        }\n                }).then(response=>{\n                    this.username = this.newUsername;\n                    this.password = this.newPassword;\n                    this.newPassword = '';\n                    this.newUsername = '';\n                    console.log(response);\n                    if(response.status === 204)\n                    {\n\n                        this.$message(\n\n                            {\n                                type: 'warning',\n                                message: 'The username is existed !'\n                            });\n                        this.showLogin = true;\n                        this.dialog_createUser  = true;\n                        this.username = '';\n                        this.password = '';\n                    }\n                    else {\n\n                        this.$axios({\n                            url: '/getUserGraph',\n                            method: 'post',\n                            data:\n                                {\n                                    user: this.username,\n                                    password: this.password\n\n                                }\n                        }).then(response => {\n\n                            this.showLogin = false;\n                            let user_nodes = response.data.nodes;\n                            let user_links = response.data.links;\n                            let change_node_type = user_nodes.map(function (element) {\n                                element.id = Number(element.id);\n                                return element\n                            });\n                            let change_link_type = user_links.map(function (element) {\n                                element.id = Number(element.id);\n                                element.source = Number(element.source);\n                                element.target = Number(element.target);\n                                return element\n                            });\n\n                            this.info.nodes = change_node_type;\n                            this.info.links = change_link_type;\n                            this.current_user = response.data.user;\n\n                            this.renderGraph(this.info)\n\n\n                        })\n                    }\n                })\n\n            },\n\n            getWikipedia:function(){\n\n                const myStream = hahaha.list('/wiki_articles_list.7z')\n                console.log(myStream)\n\n\n\n\n                // this.$axios({\n                //\n                //     method : 'get',\n                //     url : '/getAllWikipediaArticles',\n                //     data: {}\n                // }).then(response=>{\n                //     console.log(response)\n                // })\n            },\n\n\n            handleShow:function(){\n\n\n\n\n                    this.centerDialogVisible=false;\n                    this.$axios({\n                        url:'/getUserGraph',\n                        method:'post',\n                        data:{\n                            // user : \"some_user\",\n                            // password: \"my_password\"\n                            user : this.username,\n                            password: this.password\n                        }\n\n                    }).then(response=>{\n                            this.showLogin=false;\n                            console.log('haha',response.data);\n                            let user_nodes = response.data.nodes;\n                            let user_links = response.data.links;\n                            // let test = response.data;\n\n                            let change_node_type = user_nodes.map(function (element) {\n                                element.id = Number(element.id);\n                                return element\n                            });\n\n                            let change_link_type = user_links.map(function (element) {\n                                element.id = Number(element.id);\n                                element.source = Number(element.source);\n                                element.target = Number(element.target);\n                                return element\n                            });\n\n                            console.log(change_node_type);\n                            console.log(change_link_type);\n                            this.info.nodes = change_node_type;\n                            this.info.links = change_link_type;\n                            this.current_user = response.data.user;\n                            this.renderGraph(this.info)\n\n                    }).catch(error=>{\n                        console.log('error',error);\n                        this.showLogin = true;\n                        this.username = '';\n                        this.password = '';\n                    })\n\n\n            },\n\n            onTapLogin:function () {\n                this.centerDialogVisible=true\n            },\n\n            logout:function () {\n                this.showLogin = true;\n                this.username = '';\n                this.password = '';\n                this.info= {\n                    nodes:[],\n                        links:[]\n                };\n\n                this.renderGraph(this.info)\n\n                // this.$router.push({ path: '/' })\n            },\n\n            ////////////////////////////////////////////////////////////\n\n\n\n            showOption()\n            {\n                let inputContent = document.getElementsByClassName('el-input__inner')[0].value;\n                console.log(inputContent.length);\n                console.log(document.getElementsByClassName('el-input__inner'))\n                this.optionVisible = inputContent.length >=2;\n                console.log('option',this.optionVisible);\n                this.$forceUpdate()\n            },\n\n            showOption_link()\n            {\n                let inputContent = ''\n                if (document.getElementsByClassName('el-input__inner').length === 1) {\n                    inputContent = document.getElementsByClassName('el-input__inner')[0].value;\n                }\n                else{\n                    inputContent = document.getElementsByClassName('el-input__inner')[1].value;\n                }\n                console.log(document.getElementsByClassName('el-input__inner'))\n                console.log(inputContent.length);\n\n                this.optionVisible_link = inputContent.length >=2;\n                console.log('option',this.optionVisible_link);\n                this.$forceUpdate()\n            },\n\n\n            selectBlur(e) {\n                // 意见类型\n                this.btnChangeEnable = true;\n                if (e.target.value !== '') {\n                    console.log('No selection',e.target.value);\n                    // this.$forceUpdate()   // 强制更新\n                }\n                this.$forceUpdate()\n                this.selectClear()\n            },\n\n            selectClear() {\n                this.node_value = '';\n                this.link_value = '';\n                this.new_node_name = '';\n                this.new_link_name = '';\n                this.optionVisible = false;\n                this.optionVisible_link = false;\n                this.$forceUpdate()\n            },\n\n            selectChange(val) {\n\n                if(val !== '')\n                {\n                    this.btnChangeEnable = false\n                }\n                if(this.dialogFormVisible_link===true){\n                    this.link_value = val\n                }\n                else if (this.dialogFormVisible_change_link_name === true){\n                    this.new_link_name = val\n                }\n                else if (this.dialogFormVisible_change_node_name === true){\n                    this.new_node_name = val\n                }\n                else if(this.dialogFormVisible === true){\n                    this.node_value = val;\n                }\n                this.$forceUpdate()\n            },\n\n\n            cancel()\n            {\n                this.dialogFormVisible = false;\n                this.dialogFormVisible_link = false;\n                this.dialogFormVisible_change_node_name = false;\n                this.dialogFormVisible_change_link_name = false;\n                this.selectClear();\n                this.temp.length = 0;\n                this.newPassword = '';\n                this.newUsername = '';\n                this.btnChangeEnable = true;\n            },\n\n            addNodes(){\n                this.dialogFormVisible = false;\n                this.doubleClick(this.info, this.info.nodes, this.node_value);\n                this.selectClear();\n                this.optionVisible = false;\n                this.optionVisible_link = false;\n                this.btnChangeEnable = true;\n\n            },\n\n            change_node_name(){\n\n                this.info.nodes[this.node_id].properties.name = this.new_node_name;\n                this.dialogFormVisible_change_node_name = false;\n                this.selectClear();\n                this.optionVisible = false;\n                this.optionVisible_link = false;\n                this.btnChangeEnable = true;\n                this.renderGraph(this.info);\n            },\n\n\n            change_link_name()\n            {\n\n                this.info.links[this.link_id].label = this.new_link_name;\n                this.dialogFormVisible_change_link_name = false;\n                this.selectClear();\n                this.btnChangeEnable = true;\n                this.optionVisible = false;\n                this.optionVisible_link = false;\n                this.renderGraph(this.info)\n            },\n\n            addLinks()\n            {\n\n                this.dialogFormVisible_link = false;\n\n                if (this.temp.length === 2) {\n                    this.singleClick(this.info, this.selected_Node, this.link_value);\n                }\n\n                this.$message(\n\n                    {\n                        type: 'success',\n                        message: 'Add Links!'\n                    });\n                this.btnChangeEnable = true;\n                this.optionVisible = false;\n                this.optionVisible_link = false;\n                this.selectClear()\n\n            },\n\n\n            renderGraph(info) {\n                // let temp = [];\n\n\n                console.log('render data',info);\n                let {links, nodes} = info;\n\n                //关系分组\n                setLinkGroup(links);\n\n\n                d3.select(\"#graph\").html('');\n\n\n                let force = d3.layout.force()//layout将json格式转化为力学图可用的格式\n                    .nodes(nodes)//设定节点数组\n                    .links(links)//设定连线数组\n                    .linkDistance(500)//连接线长度\n                    .charge(-1500)//顶点的电荷数。该参数决定是排斥还是吸引，数值越小越互相排斥\n                    .on(\"tick\", function (){\n                            tick()\n                        },\n                    )//指时间间隔，隔一段时间刷新一次画面\n                    .start();//开始转换\n\n\n\n                let zoom = d3.behavior.zoom()\n                    .scaleExtent([.4, 2])\n                    .on(\"zoom\", zoomed);\n\n                let svg = d3.select(\"#graph\").append(\"svg\")\n                    .attr(\"pointer-event\", \"all\")\n                    .attr(\"preserveAspectRatio\", \"xMidYMid meet\")//自适应容器大小\n                    .attr(\"viewBox\", \"-460 -220 1200 1200\")\n                    // .on(\"dblclick\", doubleClick)\n                    .call(zoom);\n\n\n\n\n                // old_nodes = nodes;\n                let circle_g = svg.selectAll(\"circle\")\n                    .data(force.nodes())//表示使用force.nodes数据\n                    .enter()\n                    .append(\"g\")\n                    .attr(\"class\",function(node,i){\n                        return \"g_circle_\" + i; })//标记circle的父节点\n                    .style(\"cursor\",\"pointer\")\n                    .call(drag()) //将当前选中的元素传到drag函数中，使顶点可以被拖动\n                    .on(\"click\", (node, i,) => {\n                        if (d3.event.defaultPrevented) return;\n\n                        // console.log('鼠标单击',this.clickTimeId);\n                        // console.log(d3.select(this))\n                        clearTimeout(this.clickTimeId);\n\n                        this.clickTimeId = setTimeout( ()=> {\n\n                                // console.log(\"鼠标单击\");\n\n                                // this.selected_Node = node;\n                                // this.addLinks()\n                                // console.log('selected_Node',this.selected_Node)\n                                this.temp.push(node.index);\n                                console.log('liuliu',this.temp);\n                                if(this.temp.length === 2 && this.temp[0] !== this.temp[1]){\n                                    this.dialogFormVisible_link = true;\n\n                                }\n                                else if(this.temp.length === 2 && this.temp[0] === this.temp[1])\n                                {\n                                    this.temp.length = 0\n                                }\n                                // this.singleClick(info, node, temp, this.state2);\n                                clickStyle(node, i, this);\n                            }\n                            , 250);\n                    })\n\n                    // .on('mouseover', (node) => {\n                    //     if (d3.event.defaultPrevented) return;\n                    //     // showNodeInfo(node, this);\n                    //     // showCircleBorderOuterArc(node, i);\n                    // })\n                    .on(\"dblclick\", (node, )=>{\n\n\n                        if (d3.event.defaultPrevented) return;\n                        console.log('double click',nodes);\n                        clearTimeout(this.clickTimeId);\n                        console.log('双击',this.clickTimeId);\n                        this.dialogFormVisible = true;\n                        // this.doubleClick(info, node, nodes, links)\n\n\n                    })\n                    .on('contextmenu',(d,node)=>{\n                        console.log('node!!!!!',d,node);\n                        Menu(this.menu)(d, d3.event, node)\n\n                    });\n\n\n\n\n                svg.on(\"dblclick.zoom\", null);//取消svg和圆圈的双击放大事件（d3中默认开启7个事件，关闭防止与上面的双击事件冲突）\n                circle_g.on(\"dblclick.zoom\", null);\n\n\n\n                //单击改变节点颜色 表明选中\n                function clickStyle(node, i, _this){\n\n                    console.log(_this.ifClicked);\n                    // _this.ifClicked = true;\n\n\n                    circle_g.attr('node', function(n) {\n\n                        console.log('click change color',n.id,node.id);\n                        console.log('selected node',n.index,node.index);\n\n                        if(n.index === node.index && _this.ifClicked===false ) {\n                            d3.select('.g_circle_'+ n.index).select('circle').style('fill','red');\n                            // 有问题！！！！！！！\n                            console.log('haha',d3.select('.g_circle_'+ n.index).select('circle'));\n                            _this.ifClicked = true;\n                            console.log('新选的 true',_this.ifClicked);\n\n                        }\n                        else if(n.index === node.index && _this.ifClicked===true )\n                        {\n                            d3.select('.g_circle_'+ n.index).select('circle')\n                                .style('fill', function (node) { return getCircleColor(node);});\n                            _this.ifClicked = false;\n                            console.log('重复选的颜色变回去 false',_this.ifClicked);\n\n                        }\n                        else if(n.index !== node.index) {\n                            console.log('node are different');\n                            d3.select('.g_circle_'+ n.index)\n                                .select('circle')\n                                .style('fill', function (node) { return getCircleColor(node);})\n\n                        }\n                    });\n                }\n\n\n\n\n                //圆圈\n                let circle = circle_g.append(\"circle\")\n                    .style(\"stroke-width\", \"2px\")\n                    .attr(\"r\", 30)//设置圆圈半径\n                    .style(\"fill\", function (node) { return getCircleColor(node); });\n\n                let text = circle_g.append(\"text\")\n                    .attr(\"dy\", \".35em\")\n                    .attr(\"text-anchor\", \"middle\")//在圆圈中加上数据\n                    .style('fill', \"#FFFFFF\")\n                    .attr('x',function(d){ appendCircleText(d, this); });\n\n                //圆圈的提示文字\n                circle.append(\"svg:title\").text(function(node) {\n                    switch (node.type) {\n                        case 'node': return node.properties.name;\n                        // case 'Device': return node.factoryCode;\n                        // case 'Application': return node.applicationName;\n                        // case 'Position': return node.positionCode;\n                        // case 'Manufacturer': return node.manufacturerName;\n                        // case 'IotInfrastructure': return node.iotInfrastructureName;\n                        // case 'DeviceAdmin': return node.name;\n                    }\n                });\n                text.append(\"svg:title\").text(function(node) {\n                    switch (node.type) {\n                        case 'node': return node.properties.name;\n                        // case 'Device': return node.factoryCode;\n                        // case 'Application': return node.applicationName;\n                        // case 'Position': return node.positionCode;\n                        // case 'Manufacturer': return node.manufacturerName;\n                        // case 'IotInfrastructure': return node.iotInfrastructureName;\n                        // case 'DeviceAdmin': return node.name;\n                    }\n                });\n                //设置连接线\n                let defs = svg.append(\"defs\");\n\n                defs.append(\"marker\")\n                    .attr(\"id\", \"end\")\n                    .attr(\"markerUnits\",\"strokeWidth\")//设置为strokeWidth箭头会随着线的粗细发生变化\n                    .attr(\"markerUnits\", \"userSpaceOnUse\")\n                    .attr(\"markerWidth\", 20)//标识的大小\n                    .attr(\"markerHeight\", 20)\n                    .attr(\"viewBox\", \"0 -4 12 15\")//坐标系的区域\n                    .attr(\"refX\", 0)//箭头坐标\n                    .attr(\"refY\", 0)\n                    .attr(\"orient\", 'auto')//绘制方向，可设定为：auto（自动确认方向）和 角度值\n                    .append(\"svg:path\")\n                    .attr(\"stroke-width\",5)//箭头宽度\n                    .attr(\"d\", \"M0,-5L10,0L0,5\")//箭头的路径\n                    .attr('fill', 'rgba(0,0,0, 0.4)');//箭头颜色\n\n                defs.append(\"marker\")\n                    .attr(\"id\", \"start\")\n                    .attr(\"markerUnits\",\"strokeWidth\")//设置为strokeWidth箭头会随着线的粗细发生变化\n                    .attr(\"markerUnits\", \"userSpaceOnUse\")\n                    .attr(\"markerWidth\", 20)//标识的大小\n                    .attr(\"markerHeight\", 20)\n                    .attr(\"viewBox\", \"0 -4 12 15\")//坐标系的区域\n                    .attr(\"refX\", 0)//箭头坐标\n                    .attr(\"refY\", 0)\n                    .attr(\"orient\", 'auto')//绘制方向，可设定为：auto（自动确认方向）和 角度值\n                    .append(\"svg:path\")\n                    .attr(\"stroke-width\",5)//箭头宽度\n                    .attr(\"d\", \"M0,0L10,-5L10,5\")//箭头的路径\n                    .attr('fill', 'rgba(0,0,0, 2)');//箭头颜色\n\n                const edges_line = svg.append(\"g\").selectAll(\".edgepath\")\n                    .data(force.links())\n                    .enter()\n                    .append(\"path\")\n\n                    // .attr('marker-end', function(d,i) {\n                    //     console.log('lala',d.label,d.x_start)\n                    //     if (d.x_start < d.x_end) {\n                    //         console.log('source < end')\n                    //         return  \"url(#end)\";\n                    //     }\n                    //     return ''\n                    // })\n                    // .attr('marker-start', function(d,i) {\n                    //     if (d.x_start >= d.x_end) {\n                    //         console.log('source > end')\n                    //         return \"url(#start)\";\n                    //     }\n                    //     return ''\n                    //\n                    // })\n                    // .attr(\"marker-start\", \"url(#start)\")\n                    // .attr(\"marker-end\",  function (d, i) { return getMarkerArrow(i); })//根据箭头标记的id号标记箭头\n                    // .attr(\"marker-end\",  )//根据箭头标记的id号标记箭头\n                    .style(\"stroke\", 'black')\n                    .style(\"stroke-width\", 3)//线条粗细\n                    .style(\"fill-opacity\",0)\n                    .style(\"cursor\",\"pointer\")\n                    .attr(\"id\", function (d, i) { return 'edgepath' + i; })\n                    .on(\"mouseover\", function(d){ return getStrokeWidth(d); })\n                    .on(\"mouseout\", function() { edges_line.style(\"stroke-width\", 3) })\n                    // .on('click', (link) => { this.deleteLine(this.info,link); })\n                    .on('contextmenu',(d,link)=>{\n                        console.log(d);\n                        console.log('link!!!',link)\n                        Menu(this.menu_edge)(d,d3.event,link)\n\n                    });\n\n                const edges_text = svg.append(\"g\").selectAll(\".edgetext\")\n                    .data(links)\n                    .enter()\n                    .append(\"text\")\n                    .style(\"pointer-events\", \"none\")\n                    .attr(\"class\",\"linetext\")\n                    .attr('text-anchor', \"middle\")\n                    .attr(\"fill-opacity\", 0.5)\n                    .style(\"cursor\",\"pointer\")\n\n                    .attr({'class': 'edgelabel',\n                        'id': function (d, i) { return 'edgepath' + i; },\n                        'dx': 190, 'dy': 20,\n                        'fill':'black',\n                        // 'transform': edge_text_Position()\n                    });\n\n\n\n                function edge_text_Position(){\n\n                    return 'rotate(180,40,5)'\n                }\n\n\n\n                //设置线条上的文字\n                edges_text.append('textPath')\n                    .attr('xlink:href', function (d, i) { return '#edgepath' + i })\n                    .attr(\"pointer-events\", \"none\")\n                    .attr(\"font-size\", 20)\n                    .text(function (d) { return d.label; });\n\n\n\n                // force.on(\"tick\", tick)//指时间间隔，隔一段时间刷新一次画面\n                //     .start();//开始转换\n                function zoomed() {//svg下的g标签移动大小\n                    svg.selectAll(\"g\").attr(\"transform\", \"translate(\"  +d3.event.translate + \")scale(\" +d3.event.scale + \")\");\n                }\n\n                function getMarkerArrow(i) {\n                    svg.append(\"defs\").append(\"marker\")   //箭头\n                        .attr(\"id\", \"arrow\"+i)\n                        .attr(\"markerUnits\",\"strokeWidth\")//设置为strokeWidth箭头会随着线的粗细发生变化\n                        .attr(\"markerUnits\", \"userSpaceOnUse\")\n                        .attr(\"markerWidth\", 20)//标识的大小\n                        .attr(\"markerHeight\", 20)\n                        .attr(\"viewBox\", \"0 -4 12 15\")//坐标系的区域\n                        .attr(\"refX\", 0)//箭头坐标\n                        .attr(\"refY\", 0)\n                        .attr(\"orient\", 'auto')//绘制方向，可设定为：auto（自动确认方向）和 角度值\n                        .append(\"svg:path\")\n                        .attr(\"stroke-width\",5)//箭头宽度\n                        .attr(\"d\", \"M0,-5L10,0L0,5\")//箭头的路径\n                        .attr('fill', 'rgba(0,0,0, 0.4)');//箭头颜色\n                    return \"url(#arrow_end\" + i + \")\";\n                }\n\n\n\n                function getStrokeWidth(d) {\n                    edges_line.style(\"stroke-width\", function (edge) {\n                        // return edge.relation.relationshipId === d.relation.relationshipId ? 3 : 1;\n                        return 6\n                    });\n                }\n\n                function drag(){//拖拽函数\n                    return force.drag().on(\"dragstart\",function(d){\n                        d3.event.sourceEvent.stopPropagation(); //取消默认事件\n                        d.fixed = true;//拖拽开始后设定被拖拽对象为固定\n                    });\n                }\n\n                function getCircleColor(node) {\n                    let color = {\n                        'Device': \"#FF9D00\",\n                        'Position': \"#C477E9\",\n                        'Work': '#67CAF4',\n                        'Install': '#BCDD73',\n                        'Application': '#DD1E9E',\n                        'Manufacturer': '#DDBA9E',\n                        'IotInfrastructure': '#6ca5dd',\n                        'DeviceAdmin': '#50DD87',\n                    };//圆圈背景色\n                    return color[node.label] || '#C477E9';\n                }\n\n                function appendCircleText(d, _this) {\n                    let circleText = '';\n                    if(d.type === 'node' && d.properties.name) {\n                        circleText = d.properties.name;\n                    } else if(d.label === 'Position') {\n                        circleText = d.positionCode;\n                    } else if (d.label === 'Application') {\n                        circleText = d.applicationName;\n                    } else if (d.label === 'Manufacturer') {\n                        circleText = d.manufacturerName;\n                    } else if (d.label === 'IotInfrastructure') {\n                        circleText = d.iotInfrastructureName;\n                    } else if (d.label === 'DeviceAdmin') {\n                        circleText = d.name;\n                    }\n                    //如果小于四个字符，不换行\n                    if(circleText && circleText.length > 14){\n                        circleText = circleText.substring(0,14) + \"...\";\n                        d3.select(_this).text(function(){return '';});\n                    }\n                    d3.select(_this).append('tspan').attr('x',0).attr('y',0).attr(\"font-size\", 10)\n                        .text(function(){ return circleText; });\n                }\n\n\n\n\n\n\n                function tick() {\n\n                    circle.attr(\"transform\", transform1);//圆圈\n                    text.attr(\"transform\", transform2);//顶点文字\n                    //link奇数有问题\n                    edges_line\n                        .attr('d', function (d) {\n\n                        return getNodesLine(d,edges_line,defs);//曲线路径\n\n                    });\n                    edges_line.attr('marker-end', function(d,i) {\n                            if (d.x_start < d.x_end) {\n                                // console.log('source < end')\n                                return  \"url(#end)\";\n                            }\n                            return ''\n                        }).attr('marker-start', function(d,i) {\n                        if (d.x_start >= d.x_end) {\n                            // console.log('source > end')\n                            return \"url(#start)\";\n                        }\n                        return ''\n\n                    })\n                    ;\n\n\n                }\n\n                //设置圆圈和文字的坐标\n                function transform1(d) {\n                    return \"translate(\" + d.x + \",\" + d.y + \")\";\n                }\n\n                function transform2(d) {\n                    return \"translate(\" + (d.x) + \",\" + d.y + \")\";\n                }\n\n\n\n                function Menu (menu, openCallback) {\n\n                    d3.event.preventDefault();\n\n                    d3.selectAll('.d3-context-menu').data([1])\n                        .enter()\n                        .append('div')\n                        .attr('class', 'd3-context-menu')\n\n                    // close menu\n                    d3.select('body').on('click.d3-context-menu', function () {\n                        d3.select('.d3-context-menu').style('display', 'none')\n                    });\n\n                    return (select, event, data)=> {\n\n\n                        console.log(select.type);\n                        console.log('select',data);\n                        let elm = this;\n\n\n                        d3.selectAll('.d3-context-menu').html('');\n                        let list = d3.selectAll('.d3-context-menu').append('ul');\n\n                        list.selectAll('li').data(menu).enter()\n                            .append('li')\n                            .html(function (d) {\n                                return d.title\n                            })\n                            .on('click', function (d) {\n\n\n                                d.action(data, select);\n\n                                d3.select('.d3-context-menu').style('display', 'none')\n                            });\n\n                        // the openCallback allows an action to fire before the menu is displayed\n                        // an example usage would be closing a tooltip\n                        if (openCallback) openCallback(data);\n\n                        // display context menu\n\n                        d3.select('.d3-context-menu')\n                            .style('left', (event.pageX - 2) + 'px')\n                            .style('top', (event.pageY - 2) + 'px')\n                            .style('display', 'block');\n                        d3.event.preventDefault();\n                        // return false\n                    }\n\n                }\n\n\n            },\n\n            doubleClick(info,nodes, input){\n\n\n                let new_node = {\n                    'id': nodes.length,\n                    \"type\": \"node\",\n                    'properties': {'name': input}\n                };\n\n                console.log('6. add node');\n                info.nodes.push(new_node);\n                this.renderGraph(info);\n\n\n            },\n\n            singleClick(info, node,input){\n                // let temp = [];\n                console.log('single click!');\n                console.log('node id', node);\n                // let source = node.id;\n\n\n                if(this.temp.length ===2 && this.temp[0] !== this.temp[1] )\n                {\n\n\n                    let new_link = {\n                        \"source\": this.temp[0],\n                        \"target\": this.temp[1],\n                        \"type\": 'link',\n                        \"properties\": {},\n                        \"label\": input\n\n                    };\n\n                    info.links.push(new_link);\n                    console.log('new link added', info.links);\n                    this.temp.length = 0;\n                    this.renderGraph(info)\n\n                }\n                else if(this.temp.length ===2 && this.temp[0] === this.temp[1] )\n                {\n                    this.temp.length = 0;\n                }\n\n                if (this.temp.length ===0){\n                    this.renderGraph(info)\n                }\n\n                console.log('current select node id',this.temp)\n\n\n            },\n\n\n            submitData(){\n                console.log('submit data',this.info);\n\n                alert('Submit Successfully!');\n                console.log('current user', this.current_user);\n                console.log(this.info.nodes);\n                console.log(this.info.links);\n\n                this.upload_nodes = this.info.nodes.map(function (element) {\n                    return { \"id\":String(element.id),\"type\": element.type,\"label\": element.label, \"properties\": {\n                            \"name\": element.properties.name\n                        }}\n\n                });\n                //\n                this.upload_links = this.info.links.map(function (element) {\n\n                    return {\"type\":element.type, \"id\":String(element.id), \"label\": element.label,\n                        \"source\":String(element.source.id), \"target\":String(element.target.id),\n                        \"properties\":element.properties}\n                });\n                //\n                console.log('nn',JSON.stringify(this.upload_nodes));\n                console.log('nn',JSON.stringify(this.upload_links));\n                // console.log('ll',upload_links);\n\n\n\n                this.$axios({\n                    headers:{\n                        'Content-Type': 'application/json;'\n                    },\n                    url:'/postUserGraph',\n                    method:'post',\n                    data:{\n                        user : this.current_user,\n                        nodes: this.upload_nodes,\n                        // nodes:[\n                        //     {\n                        //         \"type\": \"node\",\n                        //         \"id\": \"0\",\n                        //         \"label\": \"Concept\",\n                        //         \"properties\": {\n                        //             \"name\": \"Innovation\"\n                        //         }\n                        //     },\n                        //     {\n                        //         \"type\": \"node\",\n                        //         \"id\": \"1\",\n                        //         \"label\": \"Concept\",\n                        //         \"properties\": {\n                        //             \"name\": \"Globalization\"\n                        //         }\n                        //     }],\n                        links: this.upload_links\n                        // links:  [\n                        //     {\n                        //         \"type\": \"link\",\n                        //         \"id\": \"0\",\n                        //         \"label\": \"benefits\",\n                        //         \"source\": \"0\",\n                        //         \"target\": \"1\",\n                        //         \"properties\": {}\n                        //     }\n                        // ]\n                    }\n\n\n                }).then(response=>{\n                    console.log('success',response)\n                    this.renderGraph(this.info)\n                })\n            },\n\n            reload(){\n                this.renderGraph(this.info)\n            },\n\n            deleteNodes(node,info){\n                console.log('select delete node',node)\n            },\n\n\n\n\n            removeNodeClick(){\n\n                console.log('remove node')\n\n            },\n\n\n\n\n\n\n\n\n        }\n\n\n    }\n</script>\n\n<style>\n    #graph {\n        width: 100vw;\n        height: 100vh;\n    }\n\n    .d3-context-menu {\n        position: absolute;\n        display: none;\n        background-color: #f2f2f2;\n        border-radius: 4px;\n\n        font-family: Arial, sans-serif;\n        font-size: 14px;\n        min-width: 150px;\n        border: 1px solid #d4d4d4;\n\n        z-index:1200;\n    }\n\n    .d3-context-menu ul {\n        list-style-type: none;\n        margin: 4px 0px;\n        padding: 0px;\n        cursor: default;\n    }\n\n    .d3-context-menu ul li {\n        padding: 4px 16px;\n    }\n\n    .d3-context-menu ul li:hover {\n        background-color: #4677f8;\n        color: #fefefe;\n    }\n\n\n</style>\n\n"]}]}